"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("aws-cdk-lib");
const aws_cdk_lib_1 = require("aws-cdk-lib");
const assertions_1 = require("aws-cdk-lib/assertions");
const lib_1 = require("../lib");
describe('deployment strategy', () => {
    test('default deployment strategy', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            rolloutStrategy: lib_1.RolloutStrategy.linear({
                growthFactor: 10,
                deploymentDuration: cdk.Duration.minutes(10),
            }),
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'MyDeploymentStrategy',
            DeploymentDurationInMinutes: 10,
            GrowthFactor: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'LINEAR',
        });
    });
    test('deployment strategy with name', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            deploymentStrategyName: 'TestDeploymentStrategy',
            rolloutStrategy: lib_1.RolloutStrategy.linear({
                growthFactor: 10,
                deploymentDuration: cdk.Duration.minutes(10),
            }),
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'TestDeploymentStrategy',
            DeploymentDurationInMinutes: 10,
            GrowthFactor: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'LINEAR',
        });
    });
    test('deployment strategy duration in seconds', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            deploymentStrategyName: 'TestDeploymentStrategy',
            rolloutStrategy: lib_1.RolloutStrategy.linear({
                growthFactor: 10,
                deploymentDuration: cdk.Duration.seconds(120),
            }),
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'TestDeploymentStrategy',
            DeploymentDurationInMinutes: 2,
            GrowthFactor: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'LINEAR',
        });
    });
    test('deployment strategy with description', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            deploymentStrategyName: 'TestDeploymentStrategy',
            rolloutStrategy: lib_1.RolloutStrategy.linear({
                growthFactor: 10,
                deploymentDuration: cdk.Duration.minutes(10),
            }),
            description: 'This is my description',
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'TestDeploymentStrategy',
            DeploymentDurationInMinutes: 10,
            GrowthFactor: 10,
            ReplicateTo: 'NONE',
            Description: 'This is my description',
            GrowthType: 'LINEAR',
        });
    });
    test('deployment strategy with final bake time', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            deploymentStrategyName: 'TestDeploymentStrategy',
            rolloutStrategy: lib_1.RolloutStrategy.linear({
                growthFactor: 10,
                deploymentDuration: cdk.Duration.minutes(10),
                finalBakeTime: cdk.Duration.minutes(30),
            }),
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'TestDeploymentStrategy',
            DeploymentDurationInMinutes: 10,
            GrowthFactor: 10,
            ReplicateTo: 'NONE',
            FinalBakeTimeInMinutes: 30,
            GrowthType: 'LINEAR',
        });
    });
    test('deployment strategy with growth type', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            deploymentStrategyName: 'TestDeploymentStrategy',
            rolloutStrategy: lib_1.RolloutStrategy.exponential({
                growthFactor: 10,
                deploymentDuration: cdk.Duration.minutes(10),
            }),
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'TestDeploymentStrategy',
            DeploymentDurationInMinutes: 10,
            GrowthFactor: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'EXPONENTIAL',
        });
    });
    test('deployment strategy with replicate to', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            deploymentStrategyName: 'TestDeploymentStrategy',
            rolloutStrategy: lib_1.RolloutStrategy.linear({
                growthFactor: 10,
                deploymentDuration: cdk.Duration.minutes(10),
            }),
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'TestDeploymentStrategy',
            DeploymentDurationInMinutes: 10,
            GrowthFactor: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'LINEAR',
        });
    });
    test('from deployment strategy arn', () => {
        const stack = new cdk.Stack();
        const deploymentStrategy = lib_1.DeploymentStrategy.fromDeploymentStrategyArn(stack, 'MyDeploymentStrategy', 'arn:aws:appconfig:us-west-2:123456789012:deploymentstrategy/abc123');
        expect(deploymentStrategy.deploymentStrategyId).toEqual('abc123');
        expect(deploymentStrategy.env.account).toEqual('123456789012');
        expect(deploymentStrategy.env.region).toEqual('us-west-2');
    });
    test('from deployment strategy arn with no resource name', () => {
        const stack = new cdk.Stack();
        expect(() => {
            lib_1.DeploymentStrategy.fromDeploymentStrategyArn(stack, 'MyDeploymentStrategy', 'arn:aws:appconfig:us-west-2:123456789012:deploymentstrategy/');
        }).toThrow('Missing required deployment strategy id from deployment strategy ARN');
    });
    test('from deployment strategy id', () => {
        const cdkApp = new aws_cdk_lib_1.App();
        const stack = new cdk.Stack(cdkApp, 'Stack', {
            env: {
                region: 'us-west-2',
                account: '123456789012',
            },
        });
        const deploymentStrategy = lib_1.DeploymentStrategy.fromDeploymentStrategyId(stack, 'MyDeploymentStrategy', lib_1.DeploymentStrategyId.fromString('abc123'));
        expect(deploymentStrategy.deploymentStrategyId).toEqual('abc123');
        expect(deploymentStrategy.env.account).toEqual('123456789012');
        expect(deploymentStrategy.env.region).toEqual('us-west-2');
    });
    test('from predefined all at once deployment strategy id', () => {
        const cdkApp = new aws_cdk_lib_1.App();
        const stack = new cdk.Stack(cdkApp, 'Stack', {
            env: {
                region: 'us-west-2',
                account: '123456789012',
            },
        });
        const deploymentStrategy = lib_1.DeploymentStrategy.fromDeploymentStrategyId(stack, 'MyDeploymentStrategy', lib_1.DeploymentStrategyId.ALL_AT_ONCE);
        expect(deploymentStrategy.deploymentStrategyId).toEqual('AppConfig.AllAtOnce');
        expect(deploymentStrategy.env.account).toEqual('123456789012');
        expect(deploymentStrategy.env.region).toEqual('us-west-2');
    });
    test('from predefined canary deployment strategy id', () => {
        const cdkApp = new aws_cdk_lib_1.App();
        const stack = new cdk.Stack(cdkApp, 'Stack', {
            env: {
                region: 'us-west-2',
                account: '123456789012',
            },
        });
        const deploymentStrategy = lib_1.DeploymentStrategy.fromDeploymentStrategyId(stack, 'MyDeploymentStrategy', lib_1.DeploymentStrategyId.CANARY_10_PERCENT_20_MINUTES);
        expect(deploymentStrategy.deploymentStrategyId).toEqual('AppConfig.Canary10Percent20Minutes');
        expect(deploymentStrategy.env.account).toEqual('123456789012');
        expect(deploymentStrategy.env.region).toEqual('us-west-2');
    });
    test('from predefined linear deployment strategy id', () => {
        const cdkApp = new aws_cdk_lib_1.App();
        const stack = new cdk.Stack(cdkApp, 'Stack', {
            env: {
                region: 'us-west-2',
                account: '123456789012',
            },
        });
        const deploymentStrategy = lib_1.DeploymentStrategy.fromDeploymentStrategyId(stack, 'MyDeploymentStrategy', lib_1.DeploymentStrategyId.LINEAR_50_PERCENT_EVERY_30_SECONDS);
        expect(deploymentStrategy.deploymentStrategyId).toEqual('AppConfig.Linear50PercentEvery30Seconds');
        expect(deploymentStrategy.env.account).toEqual('123456789012');
        expect(deploymentStrategy.env.region).toEqual('us-west-2');
    });
    test('all at once deployment strategy with no bake time', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            rolloutStrategy: lib_1.RolloutStrategy.ALL_AT_ONCE,
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'MyDeploymentStrategy',
            DeploymentDurationInMinutes: 0,
            GrowthFactor: 100,
            FinalBakeTimeInMinutes: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'LINEAR',
        });
    });
    test('all at once deployment strategy with bake time', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            rolloutStrategy: lib_1.RolloutStrategy.ALL_AT_ONCE,
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'MyDeploymentStrategy',
            DeploymentDurationInMinutes: 0,
            GrowthFactor: 100,
            FinalBakeTimeInMinutes: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'LINEAR',
        });
    });
    test('canary deployment strategy with no bake time', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            rolloutStrategy: lib_1.RolloutStrategy.CANARY_10_PERCENT_20_MINUTES,
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'MyDeploymentStrategy',
            DeploymentDurationInMinutes: 20,
            GrowthFactor: 10,
            FinalBakeTimeInMinutes: 10,
            ReplicateTo: 'NONE',
            GrowthType: 'EXPONENTIAL',
        });
    });
    test('linear deployment strategy with no bake time', () => {
        const stack = new cdk.Stack();
        new lib_1.DeploymentStrategy(stack, 'MyDeploymentStrategy', {
            rolloutStrategy: lib_1.RolloutStrategy.LINEAR_50_PERCENT_EVERY_30_SECONDS,
        });
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppConfig::DeploymentStrategy', {
            Name: 'MyDeploymentStrategy',
            DeploymentDurationInMinutes: 1,
            GrowthFactor: 50,
            FinalBakeTimeInMinutes: 1,
            ReplicateTo: 'NONE',
            GrowthType: 'LINEAR',
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwbG95bWVudC1zdHJhdGVneS50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGVwbG95bWVudC1zdHJhdGVneS50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQW1DO0FBQ25DLDZDQUFrQztBQUNsQyx1REFBa0Q7QUFDbEQsZ0NBQW1GO0FBRW5GLFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7SUFDbkMsSUFBSSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtRQUN2QyxNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUM5QixJQUFJLHdCQUFrQixDQUFDLEtBQUssRUFBRSxzQkFBc0IsRUFBRTtZQUNwRCxlQUFlLEVBQUUscUJBQWUsQ0FBQyxNQUFNLENBQUM7Z0JBQ3RDLFlBQVksRUFBRSxFQUFFO2dCQUNoQixrQkFBa0IsRUFBRSxHQUFHLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7YUFDN0MsQ0FBQztTQUNILENBQUMsQ0FBQztRQUVILHFCQUFRLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLHFCQUFxQixDQUFDLG9DQUFvQyxFQUFFO1lBQ3BGLElBQUksRUFBRSxzQkFBc0I7WUFDNUIsMkJBQTJCLEVBQUUsRUFBRTtZQUMvQixZQUFZLEVBQUUsRUFBRTtZQUNoQixXQUFXLEVBQUUsTUFBTTtZQUNuQixVQUFVLEVBQUUsUUFBUTtTQUNyQixDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7UUFDekMsTUFBTSxLQUFLLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDOUIsSUFBSSx3QkFBa0IsQ0FBQyxLQUFLLEVBQUUsc0JBQXNCLEVBQUU7WUFDcEQsc0JBQXNCLEVBQUUsd0JBQXdCO1lBQ2hELGVBQWUsRUFBRSxxQkFBZSxDQUFDLE1BQU0s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QUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtRQUN4RCxNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUM5QixJQUFJLHdCQUFrQixDQUFDLEtBQUssRUFBRSxzQkFBc0IsRUFBRTtZQUNwRCxlQUFlLEVBQUUscUJBQWUsQ0FBQyxrQ0FBa0M7U0FDcEUsQ0FBQyxDQUFDO1FBRUgscUJBQVEsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMscUJBQXFCLENBQUMsb0NBQW9DLEVBQUU7WUFDcEYsSUFBSSxFQUFFLHNCQUFzQjtZQUM1QiwyQkFBMkIsRUFBRSxDQUFDO1lBQzlCLFlBQVksRUFBRSxFQUFFO1lBQ2hCLHNCQUFzQixFQUFFLENBQUM7WUFDekIsV0FBVyxFQUFFLE1BQU07WUFDbkIsVUFBVSxFQUFFLFFBQVE7U0FDckIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBBcHAgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBUZW1wbGF0ZSB9IGZyb20gJ2F3cy1jZGstbGliL2Fzc2VydGlvbnMnO1xuaW1wb3J0IHsgRGVwbG95bWVudFN0cmF0ZWd5LCBEZXBsb3ltZW50U3RyYXRlZ3lJZCwgUm9sbG91dFN0cmF0ZWd5IH0gZnJvbSAnLi4vbGliJztcblxuZGVzY3JpYmUoJ2RlcGxveW1lbnQgc3RyYXRlZ3knLCAoKSA9PiB7XG4gIHRlc3QoJ2RlZmF1bHQgZGVwbG95bWVudCBzdHJhdGVneScsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICBuZXcgRGVwbG95bWVudFN0cmF0ZWd5KHN0YWNrLCAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLCB7XG4gICAgICByb2xsb3V0U3RyYXRlZ3k6IFJvbGxvdXRTdHJhdGVneS5saW5lYXIoe1xuICAgICAgICBncm93dGhGYWN0b3I6IDEwLFxuICAgICAgICBkZXBsb3ltZW50RHVyYXRpb246IGNkay5EdXJhdGlvbi5taW51dGVzKDEwKSxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwQ29uZmlnOjpEZXBsb3ltZW50U3RyYXRlZ3knLCB7XG4gICAgICBOYW1lOiAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLFxuICAgICAgRGVwbG95bWVudER1cmF0aW9uSW5NaW51dGVzOiAxMCxcbiAgICAgIEdyb3d0aEZhY3RvcjogMTAsXG4gICAgICBSZXBsaWNhdGVUbzogJ05PTkUnLFxuICAgICAgR3Jvd3RoVHlwZTogJ0xJTkVBUicsXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2RlcGxveW1lbnQgc3RyYXRlZ3kgd2l0aCBuYW1lJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgIG5ldyBEZXBsb3ltZW50U3RyYXRlZ3koc3RhY2ssICdNeURlcGxveW1lbnRTdHJhdGVneScsIHtcbiAgICAgIGRlcGxveW1lbnRTdHJhdGVneU5hbWU6ICdUZXN0RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgIHJvbGxvdXRTdHJhdGVneTogUm9sbG91dFN0cmF0ZWd5LmxpbmVhcih7XG4gICAgICAgIGdyb3d0aEZhY3RvcjogMTAsXG4gICAgICAgIGRlcGxveW1lbnREdXJhdGlvbjogY2RrLkR1cmF0aW9uLm1pbnV0ZXMoMTApLFxuICAgICAgfSksXG4gICAgfSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBDb25maWc6OkRlcGxveW1lbnRTdHJhdGVneScsIHtcbiAgICAgIE5hbWU6ICdUZXN0RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgIERlcGxveW1lbnREdXJhdGlvbkluTWludXRlczogMTAsXG4gICAgICBHcm93dGhGYWN0b3I6IDEwLFxuICAgICAgUmVwbGljYXRlVG86ICdOT05FJyxcbiAgICAgIEdyb3d0aFR5cGU6ICdMSU5FQVInLFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdkZXBsb3ltZW50IHN0cmF0ZWd5IGR1cmF0aW9uIGluIHNlY29uZHMnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgbmV3IERlcGxveW1lbnRTdHJhdGVneShzdGFjaywgJ015RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgZGVwbG95bWVudFN0cmF0ZWd5TmFtZTogJ1Rlc3REZXBsb3ltZW50U3RyYXRlZ3knLFxuICAgICAgcm9sbG91dFN0cmF0ZWd5OiBSb2xsb3V0U3RyYXRlZ3kubGluZWFyKHtcbiAgICAgICAgZ3Jvd3RoRmFjdG9yOiAxMCxcbiAgICAgICAgZGVwbG95bWVudER1cmF0aW9uOiBjZGsuRHVyYXRpb24uc2Vjb25kcygxMjApLFxuICAgICAgfSksXG4gICAgfSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBDb25maWc6OkRlcGxveW1lbnRTdHJhdGVneScsIHtcbiAgICAgIE5hbWU6ICdUZXN0RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgIERlcGxveW1lbnREdXJhdGlvbkluTWludXRlczogMixcbiAgICAgIEdyb3d0aEZhY3RvcjogMTAsXG4gICAgICBSZXBsaWNhdGVUbzogJ05PTkUnLFxuICAgICAgR3Jvd3RoVHlwZTogJ0xJTkVBUicsXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2RlcGxveW1lbnQgc3RyYXRlZ3kgd2l0aCBkZXNjcmlwdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICBuZXcgRGVwbG95bWVudFN0cmF0ZWd5KHN0YWNrLCAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLCB7XG4gICAgICBkZXBsb3ltZW50U3RyYXRlZ3lOYW1lOiAnVGVzdERlcGxveW1lbnRTdHJhdGVneScsXG4gICAgICByb2xsb3V0U3RyYXRlZ3k6IFJvbGxvdXRTdHJhdGVneS5saW5lYXIoe1xuICAgICAgICBncm93dGhGYWN0b3I6IDEwLFxuICAgICAgICBkZXBsb3ltZW50RHVyYXRpb246IGNkay5EdXJhdGlvbi5taW51dGVzKDEwKSxcbiAgICAgIH0pLFxuICAgICAgZGVzY3JpcHRpb246ICdUaGlzIGlzIG15IGRlc2NyaXB0aW9uJyxcbiAgICB9KTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcENvbmZpZzo6RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgTmFtZTogJ1Rlc3REZXBsb3ltZW50U3RyYXRlZ3knLFxuICAgICAgRGVwbG95bWVudER1cmF0aW9uSW5NaW51dGVzOiAxMCxcbiAgICAgIEdyb3d0aEZhY3RvcjogMTAsXG4gICAgICBSZXBsaWNhdGVUbzogJ05PTkUnLFxuICAgICAgRGVzY3JpcHRpb246ICdUaGlzIGlzIG15IGRlc2NyaXB0aW9uJyxcbiAgICAgIEdyb3d0aFR5cGU6ICdMSU5FQVInLFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdkZXBsb3ltZW50IHN0cmF0ZWd5IHdpdGggZmluYWwgYmFrZSB0aW1lJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgIG5ldyBEZXBsb3ltZW50U3RyYXRlZ3koc3RhY2ssICdNeURlcGxveW1lbnRTdHJhdGVneScsIHtcbiAgICAgIGRlcGxveW1lbnRTdHJhdGVneU5hbWU6ICdUZXN0RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgIHJvbGxvdXRTdHJhdGVneTogUm9sbG91dFN0cmF0ZWd5LmxpbmVhcih7XG4gICAgICAgIGdyb3d0aEZhY3RvcjogMTAsXG4gICAgICAgIGRlcGxveW1lbnREdXJhdGlvbjogY2RrLkR1cmF0aW9uLm1pbnV0ZXMoMTApLFxuICAgICAgICBmaW5hbEJha2VUaW1lOiBjZGsuRHVyYXRpb24ubWludXRlcygzMCksXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcENvbmZpZzo6RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgTmFtZTogJ1Rlc3REZXBsb3ltZW50U3RyYXRlZ3knLFxuICAgICAgRGVwbG95bWVudER1cmF0aW9uSW5NaW51dGVzOiAxMCxcbiAgICAgIEdyb3d0aEZhY3RvcjogMTAsXG4gICAgICBSZXBsaWNhdGVUbzogJ05PTkUnLFxuICAgICAgRmluYWxCYWtlVGltZUluTWludXRlczogMzAsXG4gICAgICBHcm93dGhUeXBlOiAnTElORUFSJyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnZGVwbG95bWVudCBzdHJhdGVneSB3aXRoIGdyb3d0aCB0eXBlJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgIG5ldyBEZXBsb3ltZW50U3RyYXRlZ3koc3RhY2ssICdNeURlcGxveW1lbnRTdHJhdGVneScsIHtcbiAgICAgIGRlcGxveW1lbnRTdHJhdGVneU5hbWU6ICdUZXN0RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgIHJvbGxvdXRTdHJhdGVneTogUm9sbG91dFN0cmF0ZWd5LmV4cG9uZW50aWFsKHtcbiAgICAgICAgZ3Jvd3RoRmFjdG9yOiAxMCxcbiAgICAgICAgZGVwbG95bWVudER1cmF0aW9uOiBjZGsuRHVyYXRpb24ubWludXRlcygxMCksXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcENvbmZpZzo6RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgTmFtZTogJ1Rlc3REZXBsb3ltZW50U3RyYXRlZ3knLFxuICAgICAgRGVwbG95bWVudER1cmF0aW9uSW5NaW51dGVzOiAxMCxcbiAgICAgIEdyb3d0aEZhY3RvcjogMTAsXG4gICAgICBSZXBsaWNhdGVUbzogJ05PTkUnLFxuICAgICAgR3Jvd3RoVHlwZTogJ0VYUE9ORU5USUFMJyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnZGVwbG95bWVudCBzdHJhdGVneSB3aXRoIHJlcGxpY2F0ZSB0bycsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICBuZXcgRGVwbG95bWVudFN0cmF0ZWd5KHN0YWNrLCAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLCB7XG4gICAgICBkZXBsb3ltZW50U3RyYXRlZ3lOYW1lOiAnVGVzdERlcGxveW1lbnRTdHJhdGVneScsXG4gICAgICByb2xsb3V0U3RyYXRlZ3k6IFJvbGxvdXRTdHJhdGVneS5saW5lYXIoe1xuICAgICAgICBncm93dGhGYWN0b3I6IDEwLFxuICAgICAgICBkZXBsb3ltZW50RHVyYXRpb246IGNkay5EdXJhdGlvbi5taW51dGVzKDEwKSxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwQ29uZmlnOjpEZXBsb3ltZW50U3RyYXRlZ3knLCB7XG4gICAgICBOYW1lOiAnVGVzdERlcGxveW1lbnRTdHJhdGVneScsXG4gICAgICBEZXBsb3ltZW50RHVyYXRpb25Jbk1pbnV0ZXM6IDEwLFxuICAgICAgR3Jvd3RoRmFjdG9yOiAxMCxcbiAgICAgIFJlcGxpY2F0ZVRvOiAnTk9ORScsXG4gICAgICBHcm93dGhUeXBlOiAnTElORUFSJyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnZnJvbSBkZXBsb3ltZW50IHN0cmF0ZWd5IGFybicsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICBjb25zdCBkZXBsb3ltZW50U3RyYXRlZ3kgPSBEZXBsb3ltZW50U3RyYXRlZ3kuZnJvbURlcGxveW1lbnRTdHJhdGVneUFybihzdGFjaywgJ015RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgICdhcm46YXdzOmFwcGNvbmZpZzp1cy13ZXN0LTI6MTIzNDU2Nzg5MDEyOmRlcGxveW1lbnRzdHJhdGVneS9hYmMxMjMnKTtcblxuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZGVwbG95bWVudFN0cmF0ZWd5SWQpLnRvRXF1YWwoJ2FiYzEyMycpO1xuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZW52LmFjY291bnQpLnRvRXF1YWwoJzEyMzQ1Njc4OTAxMicpO1xuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZW52LnJlZ2lvbikudG9FcXVhbCgndXMtd2VzdC0yJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2Zyb20gZGVwbG95bWVudCBzdHJhdGVneSBhcm4gd2l0aCBubyByZXNvdXJjZSBuYW1lJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICBEZXBsb3ltZW50U3RyYXRlZ3kuZnJvbURlcGxveW1lbnRTdHJhdGVneUFybihzdGFjaywgJ015RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgICAgJ2Fybjphd3M6YXBwY29uZmlnOnVzLXdlc3QtMjoxMjM0NTY3ODkwMTI6ZGVwbG95bWVudHN0cmF0ZWd5LycpO1xuICAgIH0pLnRvVGhyb3coJ01pc3NpbmcgcmVxdWlyZWQgZGVwbG95bWVudCBzdHJhdGVneSBpZCBmcm9tIGRlcGxveW1lbnQgc3RyYXRlZ3kgQVJOJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2Zyb20gZGVwbG95bWVudCBzdHJhdGVneSBpZCcsICgpID0+IHtcbiAgICBjb25zdCBjZGtBcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKGNka0FwcCwgJ1N0YWNrJywge1xuICAgICAgZW52OiB7XG4gICAgICAgIHJlZ2lvbjogJ3VzLXdlc3QtMicsXG4gICAgICAgIGFjY291bnQ6ICcxMjM0NTY3ODkwMTInLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBjb25zdCBkZXBsb3ltZW50U3RyYXRlZ3kgPSBEZXBsb3ltZW50U3RyYXRlZ3kuZnJvbURlcGxveW1lbnRTdHJhdGVneUlkKHN0YWNrLCAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLCBEZXBsb3ltZW50U3RyYXRlZ3lJZC5mcm9tU3RyaW5nKCdhYmMxMjMnKSk7XG5cbiAgICBleHBlY3QoZGVwbG95bWVudFN0cmF0ZWd5LmRlcGxveW1lbnRTdHJhdGVneUlkKS50b0VxdWFsKCdhYmMxMjMnKTtcbiAgICBleHBlY3QoZGVwbG95bWVudFN0cmF0ZWd5LmVudi5hY2NvdW50KS50b0VxdWFsKCcxMjM0NTY3ODkwMTInKTtcbiAgICBleHBlY3QoZGVwbG95bWVudFN0cmF0ZWd5LmVudi5yZWdpb24pLnRvRXF1YWwoJ3VzLXdlc3QtMicpO1xuICB9KTtcblxuICB0ZXN0KCdmcm9tIHByZWRlZmluZWQgYWxsIGF0IG9uY2UgZGVwbG95bWVudCBzdHJhdGVneSBpZCcsICgpID0+IHtcbiAgICBjb25zdCBjZGtBcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKGNka0FwcCwgJ1N0YWNrJywge1xuICAgICAgZW52OiB7XG4gICAgICAgIHJlZ2lvbjogJ3VzLXdlc3QtMicsXG4gICAgICAgIGFjY291bnQ6ICcxMjM0NTY3ODkwMTInLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBjb25zdCBkZXBsb3ltZW50U3RyYXRlZ3kgPSBEZXBsb3ltZW50U3RyYXRlZ3kuZnJvbURlcGxveW1lbnRTdHJhdGVneUlkKHN0YWNrLCAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLCBEZXBsb3ltZW50U3RyYXRlZ3lJZC5BTExfQVRfT05DRSk7XG5cbiAgICBleHBlY3QoZGVwbG95bWVudFN0cmF0ZWd5LmRlcGxveW1lbnRTdHJhdGVneUlkKS50b0VxdWFsKCdBcHBDb25maWcuQWxsQXRPbmNlJyk7XG4gICAgZXhwZWN0KGRlcGxveW1lbnRTdHJhdGVneS5lbnYuYWNjb3VudCkudG9FcXVhbCgnMTIzNDU2Nzg5MDEyJyk7XG4gICAgZXhwZWN0KGRlcGxveW1lbnRTdHJhdGVneS5lbnYucmVnaW9uKS50b0VxdWFsKCd1cy13ZXN0LTInKTtcbiAgfSk7XG5cbiAgdGVzdCgnZnJvbSBwcmVkZWZpbmVkIGNhbmFyeSBkZXBsb3ltZW50IHN0cmF0ZWd5IGlkJywgKCkgPT4ge1xuICAgIGNvbnN0IGNka0FwcCA9IG5ldyBBcHAoKTtcbiAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soY2RrQXBwLCAnU3RhY2snLCB7XG4gICAgICBlbnY6IHtcbiAgICAgICAgcmVnaW9uOiAndXMtd2VzdC0yJyxcbiAgICAgICAgYWNjb3VudDogJzEyMzQ1Njc4OTAxMicsXG4gICAgICB9LFxuICAgIH0pO1xuICAgIGNvbnN0IGRlcGxveW1lbnRTdHJhdGVneSA9IERlcGxveW1lbnRTdHJhdGVneS5mcm9tRGVwbG95bWVudFN0cmF0ZWd5SWQoc3RhY2ssICdNeURlcGxveW1lbnRTdHJhdGVneScsIERlcGxveW1lbnRTdHJhdGVneUlkLkNBTkFSWV8xMF9QRVJDRU5UXzIwX01JTlVURVMpO1xuXG4gICAgZXhwZWN0KGRlcGxveW1lbnRTdHJhdGVneS5kZXBsb3ltZW50U3RyYXRlZ3lJZCkudG9FcXVhbCgnQXBwQ29uZmlnLkNhbmFyeTEwUGVyY2VudDIwTWludXRlcycpO1xuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZW52LmFjY291bnQpLnRvRXF1YWwoJzEyMzQ1Njc4OTAxMicpO1xuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZW52LnJlZ2lvbikudG9FcXVhbCgndXMtd2VzdC0yJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2Zyb20gcHJlZGVmaW5lZCBsaW5lYXIgZGVwbG95bWVudCBzdHJhdGVneSBpZCcsICgpID0+IHtcbiAgICBjb25zdCBjZGtBcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKGNka0FwcCwgJ1N0YWNrJywge1xuICAgICAgZW52OiB7XG4gICAgICAgIHJlZ2lvbjogJ3VzLXdlc3QtMicsXG4gICAgICAgIGFjY291bnQ6ICcxMjM0NTY3ODkwMTInLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBjb25zdCBkZXBsb3ltZW50U3RyYXRlZ3kgPSBEZXBsb3ltZW50U3RyYXRlZ3kuZnJvbURlcGxveW1lbnRTdHJhdGVneUlkKHN0YWNrLCAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLCBEZXBsb3ltZW50U3RyYXRlZ3lJZC5MSU5FQVJfNTBfUEVSQ0VOVF9FVkVSWV8zMF9TRUNPTkRTKTtcblxuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZGVwbG95bWVudFN0cmF0ZWd5SWQpLnRvRXF1YWwoJ0FwcENvbmZpZy5MaW5lYXI1MFBlcmNlbnRFdmVyeTMwU2Vjb25kcycpO1xuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZW52LmFjY291bnQpLnRvRXF1YWwoJzEyMzQ1Njc4OTAxMicpO1xuICAgIGV4cGVjdChkZXBsb3ltZW50U3RyYXRlZ3kuZW52LnJlZ2lvbikudG9FcXVhbCgndXMtd2VzdC0yJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FsbCBhdCBvbmNlIGRlcGxveW1lbnQgc3RyYXRlZ3kgd2l0aCBubyBiYWtlIHRpbWUnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgbmV3IERlcGxveW1lbnRTdHJhdGVneShzdGFjaywgJ015RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgcm9sbG91dFN0cmF0ZWd5OiBSb2xsb3V0U3RyYXRlZ3kuQUxMX0FUX09OQ0UsXG4gICAgfSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBDb25maWc6OkRlcGxveW1lbnRTdHJhdGVneScsIHtcbiAgICAgIE5hbWU6ICdNeURlcGxveW1lbnRTdHJhdGVneScsXG4gICAgICBEZXBsb3ltZW50RHVyYXRpb25Jbk1pbnV0ZXM6IDAsXG4gICAgICBHcm93dGhGYWN0b3I6IDEwMCxcbiAgICAgIEZpbmFsQmFrZVRpbWVJbk1pbnV0ZXM6IDEwLFxuICAgICAgUmVwbGljYXRlVG86ICdOT05FJyxcbiAgICAgIEdyb3d0aFR5cGU6ICdMSU5FQVInLFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdhbGwgYXQgb25jZSBkZXBsb3ltZW50IHN0cmF0ZWd5IHdpdGggYmFrZSB0aW1lJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgIG5ldyBEZXBsb3ltZW50U3RyYXRlZ3koc3RhY2ssICdNeURlcGxveW1lbnRTdHJhdGVneScsIHtcbiAgICAgIHJvbGxvdXRTdHJhdGVneTogUm9sbG91dFN0cmF0ZWd5LkFMTF9BVF9PTkNFLFxuICAgIH0pO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwQ29uZmlnOjpEZXBsb3ltZW50U3RyYXRlZ3knLCB7XG4gICAgICBOYW1lOiAnTXlEZXBsb3ltZW50U3RyYXRlZ3knLFxuICAgICAgRGVwbG95bWVudER1cmF0aW9uSW5NaW51dGVzOiAwLFxuICAgICAgR3Jvd3RoRmFjdG9yOiAxMDAsXG4gICAgICBGaW5hbEJha2VUaW1lSW5NaW51dGVzOiAxMCxcbiAgICAgIFJlcGxpY2F0ZVRvOiAnTk9ORScsXG4gICAgICBHcm93dGhUeXBlOiAnTElORUFSJyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuYXJ5IGRlcGxveW1lbnQgc3RyYXRlZ3kgd2l0aCBubyBiYWtlIHRpbWUnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgbmV3IERlcGxveW1lbnRTdHJhdGVneShzdGFjaywgJ015RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgcm9sbG91dFN0cmF0ZWd5OiBSb2xsb3V0U3RyYXRlZ3kuQ0FOQVJZXzEwX1BFUkNFTlRfMjBfTUlOVVRFUyxcbiAgICB9KTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcENvbmZpZzo6RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgTmFtZTogJ015RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgIERlcGxveW1lbnREdXJhdGlvbkluTWludXRlczogMjAsXG4gICAgICBHcm93dGhGYWN0b3I6IDEwLFxuICAgICAgRmluYWxCYWtlVGltZUluTWludXRlczogMTAsXG4gICAgICBSZXBsaWNhdGVUbzogJ05PTkUnLFxuICAgICAgR3Jvd3RoVHlwZTogJ0VYUE9ORU5USUFMJyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnbGluZWFyIGRlcGxveW1lbnQgc3RyYXRlZ3kgd2l0aCBubyBiYWtlIHRpbWUnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgbmV3IERlcGxveW1lbnRTdHJhdGVneShzdGFjaywgJ015RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgcm9sbG91dFN0cmF0ZWd5OiBSb2xsb3V0U3RyYXRlZ3kuTElORUFSXzUwX1BFUkNFTlRfRVZFUllfMzBfU0VDT05EUyxcbiAgICB9KTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcENvbmZpZzo6RGVwbG95bWVudFN0cmF0ZWd5Jywge1xuICAgICAgTmFtZTogJ015RGVwbG95bWVudFN0cmF0ZWd5JyxcbiAgICAgIERlcGxveW1lbnREdXJhdGlvbkluTWludXRlczogMSxcbiAgICAgIEdyb3d0aEZhY3RvcjogNTAsXG4gICAgICBGaW5hbEJha2VUaW1lSW5NaW51dGVzOiAxLFxuICAgICAgUmVwbGljYXRlVG86ICdOT05FJyxcbiAgICAgIEdyb3d0aFR5cGU6ICdMSU5FQVInLFxuICAgIH0pO1xuICB9KTtcbn0pOyJdfQ==