[
  {
    "Resources": {
      "vpcA2121C38": {
        "Type": "AWS::EC2::VPC",
        "Properties": {
          "CidrBlock": "10.0.0.0/16",
          "EnableDnsHostnames": true,
          "EnableDnsSupport": true,
          "InstanceTenancy": "default",
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc"
            }
          ]
        }
      },
      "vpcPublicSubnet1Subnet2E65531E": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.0.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1a",
          "MapPublicIpOnLaunch": true,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Public"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Public"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet1RouteTable48A2DF9B": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet1RouteTableAssociation5D3F4579": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet1RouteTable48A2DF9B"
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet1Subnet2E65531E"
          }
        }
      },
      "vpcPublicSubnet1DefaultRoute10708846": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet1RouteTable48A2DF9B"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "GatewayId": {
            "Ref": "vpcIGWE57CBDCA"
          }
        },
        "DependsOn": [
          "vpcVPCGW7984C166"
        ]
      },
      "vpcPublicSubnet1EIPDA49DCBE": {
        "Type": "AWS::EC2::EIP",
        "Properties": {
          "Domain": "vpc",
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet1NATGateway9C16659E": {
        "Type": "AWS::EC2::NatGateway",
        "Properties": {
          "AllocationId": {
            "Fn::GetAtt": [
              "vpcPublicSubnet1EIPDA49DCBE",
              "AllocationId"
            ]
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet1Subnet2E65531E"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet1"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2Subnet009B674F": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.64.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1b",
          "MapPublicIpOnLaunch": true,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Public"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Public"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2RouteTableEB40D4CB": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2RouteTableAssociation21F81B59": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet2RouteTableEB40D4CB"
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet2Subnet009B674F"
          }
        }
      },
      "vpcPublicSubnet2DefaultRouteA1EC0F60": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPublicSubnet2RouteTableEB40D4CB"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "GatewayId": {
            "Ref": "vpcIGWE57CBDCA"
          }
        },
        "DependsOn": [
          "vpcVPCGW7984C166"
        ]
      },
      "vpcPublicSubnet2EIP9B3743B1": {
        "Type": "AWS::EC2::EIP",
        "Properties": {
          "Domain": "vpc",
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPublicSubnet2NATGateway9B8AE11A": {
        "Type": "AWS::EC2::NatGateway",
        "Properties": {
          "AllocationId": {
            "Fn::GetAtt": [
              "vpcPublicSubnet2EIP9B3743B1",
              "AllocationId"
            ]
          },
          "SubnetId": {
            "Ref": "vpcPublicSubnet2Subnet009B674F"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PublicSubnet2"
            },
            {
              "Key": "kubernetes.io/role/elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet1Subnet934893E8": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.128.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1a",
          "MapPublicIpOnLaunch": false,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet1"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Private"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Private"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet1RouteTableB41A48CC": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet1"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet1RouteTableAssociation67945127": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet1RouteTableB41A48CC"
          },
          "SubnetId": {
            "Ref": "vpcPrivateSubnet1Subnet934893E8"
          }
        }
      },
      "vpcPrivateSubnet1DefaultRoute1AA8E2E5": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet1RouteTableB41A48CC"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "NatGatewayId": {
            "Ref": "vpcPublicSubnet1NATGateway9C16659E"
          }
        }
      },
      "vpcPrivateSubnet2Subnet7031C2BA": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "CidrBlock": "10.0.192.0/18",
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "AvailabilityZone": "test-region-1b",
          "MapPublicIpOnLaunch": false,
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet2"
            },
            {
              "Key": "aws-cdk:subnet-name",
              "Value": "Private"
            },
            {
              "Key": "aws-cdk:subnet-type",
              "Value": "Private"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet2RouteTable7280F23E": {
        "Type": "AWS::EC2::RouteTable",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc/PrivateSubnet2"
            },
            {
              "Key": "kubernetes.io/role/internal-elb",
              "Value": "1"
            }
          ]
        }
      },
      "vpcPrivateSubnet2RouteTableAssociation007E94D3": {
        "Type": "AWS::EC2::SubnetRouteTableAssociation",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet2RouteTable7280F23E"
          },
          "SubnetId": {
            "Ref": "vpcPrivateSubnet2Subnet7031C2BA"
          }
        }
      },
      "vpcPrivateSubnet2DefaultRouteB0E07F99": {
        "Type": "AWS::EC2::Route",
        "Properties": {
          "RouteTableId": {
            "Ref": "vpcPrivateSubnet2RouteTable7280F23E"
          },
          "DestinationCidrBlock": "0.0.0.0/0",
          "NatGatewayId": {
            "Ref": "vpcPublicSubnet2NATGateway9B8AE11A"
          }
        }
      },
      "vpcIGWE57CBDCA": {
        "Type": "AWS::EC2::InternetGateway",
        "Properties": {
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-vpc/vpc"
            }
          ]
        }
      },
      "vpcVPCGW7984C166": {
        "Type": "AWS::EC2::VPCGatewayAttachment",
        "Properties": {
          "VpcId": {
            "Ref": "vpcA2121C38"
          },
          "InternetGatewayId": {
            "Ref": "vpcIGWE57CBDCA"
          }
        }
      }
    },
    "Outputs": {
      "ExportsOutputRefvpcA2121C384D1B3CDE": {
        "Value": {
          "Ref": "vpcA2121C38"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcA2121C384D1B3CDE"
        }
      },
      "ExportsOutputRefvpcPublicSubnet1Subnet2E65531ECCB85041": {
        "Value": {
          "Ref": "vpcPublicSubnet1Subnet2E65531E"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPublicSubnet1Subnet2E65531ECCB85041"
        }
      },
      "ExportsOutputRefvpcPublicSubnet2Subnet009B674FB900C242": {
        "Value": {
          "Ref": "vpcPublicSubnet2Subnet009B674F"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPublicSubnet2Subnet009B674FB900C242"
        }
      },
      "ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271": {
        "Value": {
          "Ref": "vpcPrivateSubnet1Subnet934893E8"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271"
        }
      },
      "ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE": {
        "Value": {
          "Ref": "vpcPrivateSubnet2Subnet7031C2BA"
        },
        "Export": {
          "Name": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE"
        }
      }
    }
  },
  {
    "Transform": "AWS::Serverless-2016-10-31",
    "Resources": {
      "cluster22ClusterRole5FC933B4": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "Service": "eks.amazonaws.com"
                }
              }
            ],
            "Version": "2012-10-17"
          },
          "ManagedPolicyArns": [
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKSClusterPolicy"
                ]
              ]
            },
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKSServicePolicy"
                ]
              ]
            }
          ]
        }
      },
      "cluster22ControlPlaneSecurityGroup2648B9CD": {
        "Type": "AWS::EC2::SecurityGroup",
        "Properties": {
          "GroupDescription": "EKS Control Plane Security Group",
          "SecurityGroupEgress": [
            {
              "CidrIp": "0.0.0.0/0",
              "Description": "Allow all outbound traffic by default",
              "IpProtocol": "-1"
            }
          ],
          "VpcId": {
            "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcA2121C384D1B3CDE"
          }
        }
      },
      "cluster22ControlPlaneSecurityGroupfromk8sclustercluster22NodesInstanceSecurityGroupF903AE86443C3EDA943": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "tcp",
          "Description": "from k8sclustercluster22NodesInstanceSecurityGroupF903AE86:443",
          "FromPort": 443,
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22ControlPlaneSecurityGroup2648B9CD",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "ToPort": 443
        }
      },
      "cluster22ResourceHandlerServiceRoleC2E4F327": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "Service": "lambda.amazonaws.com"
                }
              }
            ],
            "Version": "2012-10-17"
          },
          "ManagedPolicyArns": [
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                ]
              ]
            }
          ]
        }
      },
      "cluster22ResourceHandlerServiceRoleDefaultPolicy1D33C3AC": {
        "Type": "AWS::IAM::Policy",
        "Properties": {
          "PolicyDocument": {
            "Statement": [
              {
                "Action": [
                  "eks:CreateCluster",
                  "eks:DescribeCluster",
                  "eks:DeleteCluster",
                  "eks:UpdateClusterVersion"
                ],
                "Effect": "Allow",
                "Resource": "*"
              },
              {
                "Action": "iam:PassRole",
                "Effect": "Allow",
                "Resource": {
                  "Fn::GetAtt": [
                    "cluster22ClusterRole5FC933B4",
                    "Arn"
                  ]
                }
              }
            ],
            "Version": "2012-10-17"
          },
          "PolicyName": "cluster22ResourceHandlerServiceRoleDefaultPolicy1D33C3AC",
          "Roles": [
            {
              "Ref": "cluster22ResourceHandlerServiceRoleC2E4F327"
            }
          ]
        }
      },
      "cluster22ResourceHandler6227579A": {
        "Type": "AWS::Lambda::Function",
        "Properties": {
          "Code": {
            "S3Bucket": {
              "Ref": "AssetParametersf6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783bS3BucketEBE38796"
            },
            "S3Key": {
              "Fn::Join": [
                "",
                [
                  {
                    "Fn::Select": [
                      0,
                      {
                        "Fn::Split": [
                          "||",
                          {
                            "Ref": "AssetParametersf6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783bS3VersionKey0F8A19DF"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "Fn::Select": [
                      1,
                      {
                        "Fn::Split": [
                          "||",
                          {
                            "Ref": "AssetParametersf6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783bS3VersionKey0F8A19DF"
                          }
                        ]
                      }
                    ]
                  }
                ]
              ]
            }
          },
          "Handler": "index.handler",
          "Role": {
            "Fn::GetAtt": [
              "cluster22ResourceHandlerServiceRoleC2E4F327",
              "Arn"
            ]
          },
          "Runtime": "python3.7",
          "Layers": [
            {
              "Fn::GetAtt": [
                "kubectllayer8C2542BCBF2B4DFEB765E181FD30A9A0617C4ADA",
                "Outputs.LayerVersionArn"
              ]
            }
          ],
          "MemorySize": 512,
          "Timeout": 900
        },
        "DependsOn": [
          "cluster22ResourceHandlerServiceRoleDefaultPolicy1D33C3AC",
          "cluster22ResourceHandlerServiceRoleC2E4F327"
        ]
      },
      "cluster227BD1CB20": {
        "Type": "Custom::AWSCDK-EKS-Cluster",
        "Properties": {
          "ServiceToken": {
            "Fn::GetAtt": [
              "cluster22ResourceHandler6227579A",
              "Arn"
            ]
          },
          "Config": {
            "roleArn": {
              "Fn::GetAtt": [
                "cluster22ClusterRole5FC933B4",
                "Arn"
              ]
            },
            "resourcesVpcConfig": {
              "securityGroupIds": [
                {
                  "Fn::GetAtt": [
                    "cluster22ControlPlaneSecurityGroup2648B9CD",
                    "GroupId"
                  ]
                }
              ],
              "subnetIds": [
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPublicSubnet1Subnet2E65531ECCB85041"
                },
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPublicSubnet2Subnet009B674FB900C242"
                },
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271"
                },
                {
                  "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE"
                }
              ]
            }
          }
        },
        "UpdateReplacePolicy": "Delete",
        "DeletionPolicy": "Delete"
      },
      "cluster22KubernetesResourceHandler599F07E6": {
        "Type": "AWS::Lambda::Function",
        "Properties": {
          "Code": {
            "S3Bucket": {
              "Ref": "AssetParameters40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40S3Bucket93F54391"
            },
            "S3Key": {
              "Fn::Join": [
                "",
                [
                  {
                    "Fn::Select": [
                      0,
                      {
                        "Fn::Split": [
                          "||",
                          {
                            "Ref": "AssetParameters40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40S3VersionKey922FFD22"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "Fn::Select": [
                      1,
                      {
                        "Fn::Split": [
                          "||",
                          {
                            "Ref": "AssetParameters40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40S3VersionKey922FFD22"
                          }
                        ]
                      }
                    ]
                  }
                ]
              ]
            }
          },
          "Handler": "index.handler",
          "Role": {
            "Fn::GetAtt": [
              "cluster22ResourceHandlerServiceRoleC2E4F327",
              "Arn"
            ]
          },
          "Runtime": "python3.7",
          "Environment": {
            "Variables": {
              "CLUSTER_NAME": {
                "Ref": "cluster227BD1CB20"
              }
            }
          },
          "Layers": [
            {
              "Fn::GetAtt": [
                "kubectllayer8C2542BCBF2B4DFEB765E181FD30A9A0617C4ADA",
                "Outputs.LayerVersionArn"
              ]
            }
          ],
          "MemorySize": 256,
          "Timeout": 900
        },
        "DependsOn": [
          "cluster22ResourceHandlerServiceRoleDefaultPolicy1D33C3AC",
          "cluster22ResourceHandlerServiceRoleC2E4F327"
        ]
      },
      "cluster22AwsAuthmanifest4685C84D": {
        "Type": "Custom::AWSCDK-EKS-KubernetesResource",
        "Properties": {
          "ServiceToken": {
            "Fn::GetAtt": [
              "cluster22KubernetesResourceHandler599F07E6",
              "Arn"
            ]
          },
          "Manifest": {
            "Fn::Join": [
              "",
              [
                "[{\"apiVersion\":\"v1\",\"kind\":\"ConfigMap\",\"metadata\":{\"name\":\"aws-auth\",\"namespace\":\"kube-system\"},\"data\":{\"mapRoles\":\"[{\\\"rolearn\\\":\\\"",
                {
                  "Fn::GetAtt": [
                    "AdminRole38563C57",
                    "Arn"
                  ]
                },
                "\\\",\\\"groups\\\":[\\\"system:masters\\\"]},{\\\"rolearn\\\":\\\"",
                {
                  "Fn::GetAtt": [
                    "cluster22NodesInstanceRole51CD052F",
                    "Arn"
                  ]
                },
                "\\\",\\\"username\\\":\\\"system:node:{{EC2PrivateDNSName}}\\\",\\\"groups\\\":[\\\"system:bootstrappers\\\",\\\"system:nodes\\\"]}]\",\"mapUsers\":\"[]\",\"mapAccounts\":\"[]\"}}]"
              ]
            ]
          }
        },
        "UpdateReplacePolicy": "Delete",
        "DeletionPolicy": "Delete"
      },
      "cluster22NodesInstanceSecurityGroup4A3CDC24": {
        "Type": "AWS::EC2::SecurityGroup",
        "Properties": {
          "GroupDescription": "k8s-cluster/cluster22/Nodes/InstanceSecurityGroup",
          "SecurityGroupEgress": [
            {
              "CidrIp": "0.0.0.0/0",
              "Description": "Allow all outbound traffic by default",
              "IpProtocol": "-1"
            }
          ],
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-cluster/cluster22/Nodes"
            },
            {
              "Key": {
                "Fn::Join": [
                  "",
                  [
                    "kubernetes.io/cluster/",
                    {
                      "Ref": "cluster227BD1CB20"
                    }
                  ]
                ]
              },
              "Value": "owned"
            }
          ],
          "VpcId": {
            "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcA2121C384D1B3CDE"
          }
        }
      },
      "cluster22NodesInstanceSecurityGroupfromk8sclustercluster22NodesInstanceSecurityGroupF903AE86ALLTRAFFIC774C7781": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "-1",
          "Description": "from k8sclustercluster22NodesInstanceSecurityGroupF903AE86:ALL TRAFFIC",
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          }
        }
      },
      "cluster22NodesInstanceSecurityGroupfromk8sclustercluster22ControlPlaneSecurityGroup3B5F21B44434A6E344D": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "tcp",
          "Description": "from k8sclustercluster22ControlPlaneSecurityGroup3B5F21B4:443",
          "FromPort": 443,
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22ControlPlaneSecurityGroup2648B9CD",
              "GroupId"
            ]
          },
          "ToPort": 443
        }
      },
      "cluster22NodesInstanceSecurityGroupfromk8sclustercluster22ControlPlaneSecurityGroup3B5F21B41025655355658FCAA": {
        "Type": "AWS::EC2::SecurityGroupIngress",
        "Properties": {
          "IpProtocol": "tcp",
          "Description": "from k8sclustercluster22ControlPlaneSecurityGroup3B5F21B4:1025-65535",
          "FromPort": 1025,
          "GroupId": {
            "Fn::GetAtt": [
              "cluster22NodesInstanceSecurityGroup4A3CDC24",
              "GroupId"
            ]
          },
          "SourceSecurityGroupId": {
            "Fn::GetAtt": [
              "cluster22ControlPlaneSecurityGroup2648B9CD",
              "GroupId"
            ]
          },
          "ToPort": 65535
        }
      },
      "cluster22NodesInstanceRole51CD052F": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "Service": {
                    "Fn::Join": [
                      "",
                      [
                        "ec2.",
                        {
                          "Ref": "AWS::URLSuffix"
                        }
                      ]
                    ]
                  }
                }
              }
            ],
            "Version": "2012-10-17"
          },
          "ManagedPolicyArns": [
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKSWorkerNodePolicy"
                ]
              ]
            },
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEKS_CNI_Policy"
                ]
              ]
            },
            {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition"
                  },
                  ":iam::aws:policy/AmazonEC2ContainerRegistryReadOnly"
                ]
              ]
            }
          ],
          "Tags": [
            {
              "Key": "Name",
              "Value": "k8s-cluster/cluster22/Nodes"
            },
            {
              "Key": {
                "Fn::Join": [
                  "",
                  [
                    "kubernetes.io/cluster/",
                    {
                      "Ref": "cluster227BD1CB20"
                    }
                  ]
                ]
              },
              "Value": "owned"
            }
          ]
        }
      },
      "cluster22NodesInstanceProfile3D4963ED": {
        "Type": "AWS::IAM::InstanceProfile",
        "Properties": {
          "Roles": [
            {
              "Ref": "cluster22NodesInstanceRole51CD052F"
            }
          ]
        }
      },
      "cluster22NodesLaunchConfig184BF3BA": {
        "Type": "AWS::AutoScaling::LaunchConfiguration",
        "Properties": {
          "ImageId": {
            "Ref": "SsmParameterValueawsserviceeksoptimizedami114amazonlinux2recommendedimageidC96584B6F00A464EAD1953AFF4B05118Parameter"
          },
          "InstanceType": "t2.medium",
          "IamInstanceProfile": {
            "Ref": "cluster22NodesInstanceProfile3D4963ED"
          },
          "SecurityGroups": [
            {
              "Fn::GetAtt": [
                "cluster22NodesInstanceSecurityGroup4A3CDC24",
                "GroupId"
              ]
            }
          ],
          "UserData": {
            "Fn::Base64": {
              "Fn::Join": [
                "",
                [
                  "#!/bin/bash\nset -o xtrace\n/etc/eks/bootstrap.sh ",
                  {
                    "Ref": "cluster227BD1CB20"
                  },
                  " --kubelet-extra-args \"--node-labels lifecycle=OnDemand\" --use-max-pods true\n/opt/aws/bin/cfn-signal --exit-code $? --stack k8s-cluster --resource cluster22NodesASGC0A97398 --region test-region"
                ]
              ]
            }
          }
        },
        "DependsOn": [
          "cluster22NodesInstanceRole51CD052F"
        ]
      },
      "cluster22NodesASGC0A97398": {
        "Type": "AWS::AutoScaling::AutoScalingGroup",
        "Properties": {
          "MaxSize": "3",
          "MinSize": "1",
          "DesiredCapacity": "3",
          "LaunchConfigurationName": {
            "Ref": "cluster22NodesLaunchConfig184BF3BA"
          },
          "Tags": [
            {
              "Key": "Name",
              "PropagateAtLaunch": true,
              "Value": "k8s-cluster/cluster22/Nodes"
            },
            {
              "Key": {
                "Fn::Join": [
                  "",
                  [
                    "kubernetes.io/cluster/",
                    {
                      "Ref": "cluster227BD1CB20"
                    }
                  ]
                ]
              },
              "PropagateAtLaunch": true,
              "Value": "owned"
            }
          ],
          "VPCZoneIdentifier": [
            {
              "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet1Subnet934893E8236E2271"
            },
            {
              "Fn::ImportValue": "k8s-vpc:ExportsOutputRefvpcPrivateSubnet2Subnet7031C2BA60DCB1EE"
            }
          ]
        },
        "UpdatePolicy": {
          "AutoScalingRollingUpdate": {
            "WaitOnResourceSignals": false,
            "PauseTime": "PT0S",
            "SuspendProcesses": [
              "HealthCheck",
              "ReplaceUnhealthy",
              "AZRebalance",
              "AlarmNotification",
              "ScheduledActions"
            ]
          },
          "AutoScalingScheduledAction": {
            "IgnoreUnmodifiedGroupSizeProperties": true
          }
        }
      },
      "cluster22chartdashboard616811AB": {
        "Type": "Custom::AWSCDK-EKS-HelmChart",
        "Properties": {
          "ServiceToken": {
            "Fn::GetAtt": [
              "cluster22HelmChartHandler0BAF302E",
              "Arn"
            ]
          },
          "Release": "k8sclustercluster22chartdashboard3844c297",
          "Chart": "kubernetes-dashboard",
          "Namespace": "default",
          "Repository": "https://kubernetes-charts.storage.googleapis.com"
        },
        "UpdateReplacePolicy": "Delete",
        "DeletionPolicy": "Delete"
      },
      "cluster22HelmChartHandler0BAF302E": {
        "Type": "AWS::Lambda::Function",
        "Properties": {
          "Code": {
            "S3Bucket": {
              "Ref": "AssetParameters915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909S3BucketBBD72DD2"
            },
            "S3Key": {
              "Fn::Join": [
                "",
                [
                  {
                    "Fn::Select": [
                      0,
                      {
                        "Fn::Split": [
                          "||",
                          {
                            "Ref": "AssetParameters915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909S3VersionKey1E152B82"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "Fn::Select": [
                      1,
                      {
                        "Fn::Split": [
                          "||",
                          {
                            "Ref": "AssetParameters915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909S3VersionKey1E152B82"
                          }
                        ]
                      }
                    ]
                  }
                ]
              ]
            }
          },
          "Handler": "index.handler",
          "Role": {
            "Fn::GetAtt": [
              "cluster22ResourceHandlerServiceRoleC2E4F327",
              "Arn"
            ]
          },
          "Runtime": "python3.7",
          "Environment": {
            "Variables": {
              "CLUSTER_NAME": {
                "Ref": "cluster227BD1CB20"
              }
            }
          },
          "Layers": [
            {
              "Fn::GetAtt": [
                "kubectllayer200beta1B9303363",
                "Outputs.LayerVersionArn"
              ]
            }
          ],
          "MemorySize": 256,
          "Timeout": 900
        },
        "DependsOn": [
          "cluster22ResourceHandlerServiceRoleDefaultPolicy1D33C3AC",
          "cluster22ResourceHandlerServiceRoleC2E4F327"
        ]
      },
      "cluster22chartnginxingress90C2D506": {
        "Type": "Custom::AWSCDK-EKS-HelmChart",
        "Properties": {
          "ServiceToken": {
            "Fn::GetAtt": [
              "cluster22HelmChartHandler0BAF302E",
              "Arn"
            ]
          },
          "Release": "k8sclustercluster22chartnginxingress8b03389e",
          "Chart": "nginx-ingress",
          "Namespace": "kube-system",
          "Repository": "https://helm.nginx.com/stable"
        },
        "UpdateReplacePolicy": "Delete",
        "DeletionPolicy": "Delete"
      },
      "kubectllayer8C2542BCBF2B4DFEB765E181FD30A9A0617C4ADA": {
        "Type": "AWS::Serverless::Application",
        "Properties": {
          "Location": {
            "ApplicationId": "arn:aws:serverlessrepo:us-east-1:903779448426:applications/lambda-layer-kubectl",
            "SemanticVersion": "1.13.7"
          },
          "Parameters": {
            "LayerName": "kubectl-bedb92f2e70f45155fba70d3425dd148"
          }
        }
      },
      "AdminRole38563C57": {
        "Type": "AWS::IAM::Role",
        "Properties": {
          "AssumeRolePolicyDocument": {
            "Statement": [
              {
                "Action": "sts:AssumeRole",
                "Effect": "Allow",
                "Principal": {
                  "AWS": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition"
                        },
                        ":iam::12345678:root"
                      ]
                    ]
                  }
                }
              }
            ],
            "Version": "2012-10-17"
          }
        }
      },
      "kubectllayer200beta1B9303363": {
        "Type": "AWS::Serverless::Application",
        "Properties": {
          "Location": {
            "ApplicationId": "arn:aws:serverlessrepo:us-east-1:903779448426:applications/lambda-layer-kubectl",
            "SemanticVersion": "2.0.0-beta1"
          },
          "Parameters": {
            "LayerName": "kubectl-aa3d1881d348da39094e6b1ce165f580"
          }
        }
      }
    },
    "Outputs": {
      "cluster22ConfigCommand96B20279": {
        "Value": {
          "Fn::Join": [
            "",
            [
              "aws eks update-kubeconfig --name ",
              {
                "Ref": "cluster227BD1CB20"
              },
              " --region test-region"
            ]
          ]
        }
      },
      "cluster22GetTokenCommand99DB9B02": {
        "Value": {
          "Fn::Join": [
            "",
            [
              "aws eks get-token --cluster-name ",
              {
                "Ref": "cluster227BD1CB20"
              },
              " --region test-region"
            ]
          ]
        }
      }
    },
    "Parameters": {
      "AssetParametersf6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783bS3BucketEBE38796": {
        "Type": "String",
        "Description": "S3 bucket for asset \"f6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783b\""
      },
      "AssetParametersf6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783bS3VersionKey0F8A19DF": {
        "Type": "String",
        "Description": "S3 key for asset version \"f6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783b\""
      },
      "AssetParametersf6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783bArtifactHash4AB15A40": {
        "Type": "String",
        "Description": "Artifact hash for asset \"f6ac6aa2eaa2a4e74c5a10ef7c07691c0f77cf6cdaeacae377a330e15c4a783b\""
      },
      "AssetParameters40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40S3Bucket93F54391": {
        "Type": "String",
        "Description": "S3 bucket for asset \"40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40\""
      },
      "AssetParameters40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40S3VersionKey922FFD22": {
        "Type": "String",
        "Description": "S3 key for asset version \"40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40\""
      },
      "AssetParameters40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40ArtifactHashDB0E2F90": {
        "Type": "String",
        "Description": "Artifact hash for asset \"40543dc9fa68ea7d2e70ba5add39bca90c8fd6995387454561e9801f1a07fc40\""
      },
      "AssetParameters915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909S3BucketBBD72DD2": {
        "Type": "String",
        "Description": "S3 bucket for asset \"915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909\""
      },
      "AssetParameters915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909S3VersionKey1E152B82": {
        "Type": "String",
        "Description": "S3 key for asset version \"915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909\""
      },
      "AssetParameters915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909ArtifactHashCBD316EC": {
        "Type": "String",
        "Description": "Artifact hash for asset \"915ff34d315156b52c6d61074df8db87c5a6b08650d01b318e77c75dafb9a909\""
      },
      "SsmParameterValueawsserviceeksoptimizedami114amazonlinux2recommendedimageidC96584B6F00A464EAD1953AFF4B05118Parameter": {
        "Type": "AWS::SSM::Parameter::Value<String>",
        "Default": "/aws/service/eks/optimized-ami/1.14/amazon-linux-2/recommended/image_id"
      }
    }
  }
]