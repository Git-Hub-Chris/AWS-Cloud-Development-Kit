"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.filterLogicalId = exports.formatFailure = exports.formatSectionMatchFailure = exports.formatAllMismatches = exports.formatAllMatches = exports.matchSection = void 0;
const sorting_1 = require("./sorting");
const match_1 = require("../match");
const matcher_1 = require("../matcher");
function matchSection(section, props) {
    const matcher = matcher_1.Matcher.isMatcher(props) ? props : match_1.Match.objectLike(props);
    const matching = {};
    const analyzed = {};
    const failures = new Array();
    eachEntryInSection(section, (logicalId, entry) => {
        analyzed[logicalId] = entry;
        const result = matcher.test(entry);
        result.finished();
        if (!result.hasFailed()) {
            matching[logicalId] = entry;
        }
        else {
            failures.push([logicalId, result]);
        }
    });
    if (Object.keys(matching).length > 0) {
        return { match: true, matches: matching, analyzedCount: Object.keys(analyzed).length, analyzed: analyzed };
    }
    else {
        // Sort by cost, use logicalId as a tie breaker. Take the 3 closest
        // matches (helps debugging in case we get the top pick wrong).
        failures.sort(sorting_1.sortKeyComparator(([logicalId, result]) => [result.failCost, logicalId]));
        const closestResults = Object.fromEntries(failures.slice(0, 3));
        return { match: false, closestResults, analyzedCount: Object.keys(analyzed).length, analyzed: analyzed };
    }
}
exports.matchSection = matchSection;
function eachEntryInSection(section, cb) {
    for (const logicalId of Object.keys(section ?? {})) {
        const resource = section[logicalId];
        cb(logicalId, resource);
    }
}
function formatAllMatches(matches) {
    return [
        leftPad(JSON.stringify(matches, undefined, 2)),
    ].join('\n');
}
exports.formatAllMatches = formatAllMatches;
function formatAllMismatches(analyzed, matches = {}) {
    return [
        'The following resources do not match the given definition:',
        ...Object.keys(analyzed).filter(id => !(id in matches)).map(id => `\t${id}`),
    ].join('\n');
}
exports.formatAllMismatches = formatAllMismatches;
function formatSectionMatchFailure(qualifier, result, what = 'Template') {
    return [
        `${what} has ${result.analyzedCount} ${qualifier}`,
        result.analyzedCount > 0 ? ', but none match as expected' : '',
        '.\n',
        formatFailure(result.closestResults),
    ].join('');
}
exports.formatSectionMatchFailure = formatSectionMatchFailure;
function formatFailure(closestResults) {
    const keys = Object.keys(closestResults);
    if (keys.length === 0) {
        return 'No matches found';
    }
    return [
        `The ${keys.length} closest matches:`,
        ...keys.map(key => `${key} :: ${closestResults[key].renderMismatch()}`),
    ].join('\n');
}
exports.formatFailure = formatFailure;
function leftPad(x, indent = 2) {
    const pad = ' '.repeat(indent);
    return pad + x.split('\n').join(`\n${pad}`);
}
function filterLogicalId(section, logicalId) {
    // default signal for all logicalIds is '*'
    if (logicalId === '*')
        return section;
    return Object.entries(section ?? {})
        .filter(([k, _]) => k === logicalId)
        .reduce((agg, [k, v]) => { return { ...agg, [k]: v }; }, {});
}
exports.filterLogicalId = filterLogicalId;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInNlY3Rpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsdUNBQThDO0FBQzlDLG9DQUFpQztBQUNqQyx3Q0FBa0Q7QUFLbEQsU0FBZ0IsWUFBWSxDQUFDLE9BQVksRUFBRSxLQUFVO0lBQ25ELE1BQU0sT0FBTyxHQUFHLGlCQUFPLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLGFBQUssQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDM0UsTUFBTSxRQUFRLEdBQTJCLEVBQUUsQ0FBQztJQUM1QyxNQUFNLFFBQVEsR0FBMkIsRUFBRSxDQUFDO0lBQzVDLE1BQU0sUUFBUSxHQUFHLElBQUksS0FBSyxFQUF5QixDQUFDO0lBRXBELGtCQUFrQixDQUNoQixPQUFPLEVBQ1AsQ0FBQyxTQUFTLEVBQUUsS0FBSyxFQUFFLEVBQUU7UUFDbkIsUUFBUSxDQUFDLFNBQVMsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUM1QixNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25DLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNsQixJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxFQUFFO1lBQ3ZCLFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUM7U0FDN0I7YUFBTTtZQUNMLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztTQUNwQztJQUNILENBQUMsQ0FDRixDQUFDO0lBQ0YsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7UUFDcEMsT0FBTyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQUUs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LENBQUM7QUFWRCxzQ0FVQztBQUVELFNBQVMsT0FBTyxDQUFDLENBQVMsRUFBRSxTQUFpQixDQUFDO0lBQzVDLE1BQU0sR0FBRyxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDL0IsT0FBTyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0FBQzlDLENBQUM7QUFFRCxTQUFnQixlQUFlLENBQUMsT0FBOEIsRUFBRSxTQUFpQjtJQUMvRSwyQ0FBMkM7SUFDM0MsSUFBSSxTQUFTLEtBQUssR0FBRztRQUFFLE9BQU8sT0FBTyxDQUFDO0lBRXRDLE9BQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDO1NBQ2pDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEtBQUssU0FBUyxDQUFDO1NBQ25DLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLEdBQUcsT0FBTyxFQUFFLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDakUsQ0FBQztBQVBELDBDQU9DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc29ydEtleUNvbXBhcmF0b3IgfSBmcm9tICcuL3NvcnRpbmcnO1xuaW1wb3J0IHsgTWF0Y2ggfSBmcm9tICcuLi9tYXRjaCc7XG5pbXBvcnQgeyBNYXRjaGVyLCBNYXRjaFJlc3VsdCB9IGZyb20gJy4uL21hdGNoZXInO1xuXG5leHBvcnQgdHlwZSBNYXRjaFN1Y2Nlc3MgPSB7IG1hdGNoOiB0cnVlLCBtYXRjaGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LCBhbmFseXplZDogeyBba2V5OiBzdHJpbmddOiBhbnkgfSwgYW5hbHl6ZWRDb3VudDogbnVtYmVyIH07XG5leHBvcnQgdHlwZSBNYXRjaEZhaWx1cmUgPSB7IG1hdGNoOiBmYWxzZSwgY2xvc2VzdFJlc3VsdHM6IFJlY29yZDxzdHJpbmcsIE1hdGNoUmVzdWx0PiwgYW5hbHl6ZWQ6IHsgW2tleTogc3RyaW5nXTogYW55IH0sIGFuYWx5emVkQ291bnQ6IG51bWJlciB9O1xuXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hTZWN0aW9uKHNlY3Rpb246IGFueSwgcHJvcHM6IGFueSk6IE1hdGNoU3VjY2VzcyB8IE1hdGNoRmFpbHVyZSB7XG4gIGNvbnN0IG1hdGNoZXIgPSBNYXRjaGVyLmlzTWF0Y2hlcihwcm9wcykgPyBwcm9wcyA6IE1hdGNoLm9iamVjdExpa2UocHJvcHMpO1xuICBjb25zdCBtYXRjaGluZzogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9IHt9O1xuICBjb25zdCBhbmFseXplZDogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9IHt9O1xuICBjb25zdCBmYWlsdXJlcyA9IG5ldyBBcnJheTxbc3RyaW5nLCBNYXRjaFJlc3VsdF0+KCk7XG5cbiAgZWFjaEVudHJ5SW5TZWN0aW9uKFxuICAgIHNlY3Rpb24sXG4gICAgKGxvZ2ljYWxJZCwgZW50cnkpID0+IHtcbiAgICAgIGFuYWx5emVkW2xvZ2ljYWxJZF0gPSBlbnRyeTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IG1hdGNoZXIudGVzdChlbnRyeSk7XG4gICAgICByZXN1bHQuZmluaXNoZWQoKTtcbiAgICAgIGlmICghcmVzdWx0Lmhhc0ZhaWxlZCgpKSB7XG4gICAgICAgIG1hdGNoaW5nW2xvZ2ljYWxJZF0gPSBlbnRyeTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZhaWx1cmVzLnB1c2goW2xvZ2ljYWxJZCwgcmVzdWx0XSk7XG4gICAgICB9XG4gICAgfSxcbiAgKTtcbiAgaWYgKE9iamVjdC5rZXlzKG1hdGNoaW5nKS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIHsgbWF0Y2g6IHRydWUsIG1hdGNoZXM6IG1hdGNoaW5nLCBhbmFseXplZENvdW50OiBPYmplY3Qua2V5cyhhbmFseXplZCkubGVuZ3RoLCBhbmFseXplZDogYW5hbHl6ZWQgfTtcbiAgfSBlbHNlIHtcbiAgICAvLyBTb3J0IGJ5IGNvc3QsIHVzZSBsb2dpY2FsSWQgYXMgYSB0aWUgYnJlYWtlci4gVGFrZSB0aGUgMyBjbG9zZXN0XG4gICAgLy8gbWF0Y2hlcyAoaGVscHMgZGVidWdnaW5nIGluIGNhc2Ugd2UgZ2V0IHRoZSB0b3AgcGljayB3cm9uZykuXG4gICAgZmFpbHVyZXMuc29ydChzb3J0S2V5Q29tcGFyYXRvcigoW2xvZ2ljYWxJZCwgcmVzdWx0XSkgPT4gW3Jlc3VsdC5mYWlsQ29zdCwgbG9naWNhbElkXSkpO1xuICAgIGNvbnN0IGNsb3Nlc3RSZXN1bHRzID0gT2JqZWN0LmZyb21FbnRyaWVzKGZhaWx1cmVzLnNsaWNlKDAsIDMpKTtcbiAgICByZXR1cm4geyBtYXRjaDogZmFsc2UsIGNsb3Nlc3RSZXN1bHRzLCBhbmFseXplZENvdW50OiBPYmplY3Qua2V5cyhhbmFseXplZCkubGVuZ3RoLCBhbmFseXplZDogYW5hbHl6ZWQgfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlYWNoRW50cnlJblNlY3Rpb24oXG4gIHNlY3Rpb246IGFueSxcbiAgY2I6IChsb2dpY2FsSWQ6IHN0cmluZywgZW50cnk6IHsgW2tleTogc3RyaW5nXTogYW55IH0pID0+IHZvaWQpOiB2b2lkIHtcblxuICBmb3IgKGNvbnN0IGxvZ2ljYWxJZCBvZiBPYmplY3Qua2V5cyhzZWN0aW9uID8/IHt9KSkge1xuICAgIGNvbnN0IHJlc291cmNlOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0gc2VjdGlvbltsb2dpY2FsSWRdO1xuICAgIGNiKGxvZ2ljYWxJZCwgcmVzb3VyY2UpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRBbGxNYXRjaGVzKG1hdGNoZXM6IHsgW2tleTogc3RyaW5nXTogYW55IH0pOiBzdHJpbmcge1xuICByZXR1cm4gW1xuICAgIGxlZnRQYWQoSlNPTi5zdHJpbmdpZnkobWF0Y2hlcywgdW5kZWZpbmVkLCAyKSksXG4gIF0uam9pbignXFxuJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRBbGxNaXNtYXRjaGVzKGFuYWx5emVkOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LCBtYXRjaGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge30pOiBzdHJpbmcge1xuICByZXR1cm4gW1xuICAgICdUaGUgZm9sbG93aW5nIHJlc291cmNlcyBkbyBub3QgbWF0Y2ggdGhlIGdpdmVuIGRlZmluaXRpb246JyxcbiAgICAuLi5PYmplY3Qua2V5cyhhbmFseXplZCkuZmlsdGVyKGlkID0+ICEoaWQgaW4gbWF0Y2hlcykpLm1hcChpZCA9PiBgXFx0JHtpZH1gKSxcbiAgXS5qb2luKCdcXG4nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFNlY3Rpb25NYXRjaEZhaWx1cmUocXVhbGlmaWVyOiBzdHJpbmcsIHJlc3VsdDogTWF0Y2hGYWlsdXJlLCB3aGF0PSdUZW1wbGF0ZScpOiBzdHJpbmcge1xuICByZXR1cm4gW1xuICAgIGAke3doYXR9IGhhcyAke3Jlc3VsdC5hbmFseXplZENvdW50fSAke3F1YWxpZmllcn1gLFxuICAgIHJlc3VsdC5hbmFseXplZENvdW50ID4gMCA/ICcsIGJ1dCBub25lIG1hdGNoIGFzIGV4cGVjdGVkJyA6ICcnLFxuICAgICcuXFxuJyxcbiAgICBmb3JtYXRGYWlsdXJlKHJlc3VsdC5jbG9zZXN0UmVzdWx0cyksXG4gIF0uam9pbignJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRGYWlsdXJlKGNsb3Nlc3RSZXN1bHRzOiBSZWNvcmQ8c3RyaW5nLCBNYXRjaFJlc3VsdD4pOiBzdHJpbmcge1xuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoY2xvc2VzdFJlc3VsdHMpO1xuICBpZiAoa2V5cy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJ05vIG1hdGNoZXMgZm91bmQnO1xuICB9XG5cbiAgcmV0dXJuIFtcbiAgICBgVGhlICR7a2V5cy5sZW5ndGh9IGNsb3Nlc3QgbWF0Y2hlczpgLFxuICAgIC4uLmtleXMubWFwKGtleSA9PiBgJHtrZXl9IDo6ICR7Y2xvc2VzdFJlc3VsdHNba2V5XS5yZW5kZXJNaXNtYXRjaCgpfWApLFxuICBdLmpvaW4oJ1xcbicpO1xufVxuXG5mdW5jdGlvbiBsZWZ0UGFkKHg6IHN0cmluZywgaW5kZW50OiBudW1iZXIgPSAyKTogc3RyaW5nIHtcbiAgY29uc3QgcGFkID0gJyAnLnJlcGVhdChpbmRlbnQpO1xuICByZXR1cm4gcGFkICsgeC5zcGxpdCgnXFxuJykuam9pbihgXFxuJHtwYWR9YCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJMb2dpY2FsSWQoc2VjdGlvbjogeyBba2V5OiBzdHJpbmddOiB7fSB9LCBsb2dpY2FsSWQ6IHN0cmluZyk6IHsgW2tleTogc3RyaW5nXToge30gfSB7XG4gIC8vIGRlZmF1bHQgc2lnbmFsIGZvciBhbGwgbG9naWNhbElkcyBpcyAnKidcbiAgaWYgKGxvZ2ljYWxJZCA9PT0gJyonKSByZXR1cm4gc2VjdGlvbjtcblxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMoc2VjdGlvbiA/PyB7fSlcbiAgICAuZmlsdGVyKChbaywgX10pID0+IGsgPT09IGxvZ2ljYWxJZClcbiAgICAucmVkdWNlKChhZ2csIFtrLCB2XSkgPT4geyByZXR1cm4geyAuLi5hZ2csIFtrXTogdiB9OyB9LCB7fSk7XG59XG4iXX0=