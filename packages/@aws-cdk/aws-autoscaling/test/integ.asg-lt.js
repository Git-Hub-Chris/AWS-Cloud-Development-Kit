#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ec2 = require("@aws-cdk/aws-ec2");
const cdk = require("@aws-cdk/core");
const autoscaling = require("../lib");
const app = new cdk.App();
const stack = new cdk.Stack(app, 'aws-cdk-asg-integ');
const lt = new ec2.LaunchTemplate(stack, 'MainLT', {
    instanceType: new ec2.InstanceType('t3.micro'),
    machineImage: new ec2.AmazonLinuxImage({
        generation: ec2.AmazonLinuxGeneration.AMAZON_LINUX_2,
        cpuType: ec2.AmazonLinuxCpuType.X86_64,
    }),
});
const ltOverrideT4g = new ec2.LaunchTemplate(stack, 'T4gLT', {
    instanceType: new ec2.InstanceType('t4g.micro'),
    machineImage: new ec2.AmazonLinuxImage({
        generation: ec2.AmazonLinuxGeneration.AMAZON_LINUX_2,
        cpuType: ec2.AmazonLinuxCpuType.ARM_64,
    }),
});
const vpc = new ec2.Vpc(stack, 'VPC', {
    maxAzs: 2,
});
new autoscaling.AutoScalingGroup(stack, 'AsgFromLT', {
    vpc,
    launchTemplate: lt,
    minCapacity: 0,
    maxCapacity: 10,
    desiredCapacity: 5,
});
new autoscaling.AutoScalingGroup(stack, 'AsgWithDefaultInstanceWarmup', {
    vpc,
    launchTemplate: lt,
    defaultInstanceWarmup: cdk.Duration.seconds(5),
});
new autoscaling.AutoScalingGroup(stack, 'AsgFromMip', {
    vpc,
    mixedInstancesPolicy: {
        instancesDistribution: {
            onDemandPercentageAboveBaseCapacity: 50,
        },
        launchTemplate: lt,
        launchTemplateOverrides: [
            { instanceType: new ec2.InstanceType('t3.micro') },
            { instanceType: new ec2.InstanceType('t3a.micro') },
            { instanceType: new ec2.InstanceType('t4g.micro'), launchTemplate: ltOverrideT4g },
        ],
    },
    minCapacity: 0,
    maxCapacity: 10,
    desiredCapacity: 5,
});
new autoscaling.AutoScalingGroup(stack, 'AsgFromMipWithoutDistribution', {
    vpc,
    mixedInstancesPolicy: {
        launchTemplate: lt,
        launchTemplateOverrides: [
            { instanceType: new ec2.InstanceType('t3.micro') },
            { instanceType: new ec2.InstanceType('t3a.micro') },
            { instanceType: new ec2.InstanceType('t4g.micro'), launchTemplate: ltOverrideT4g },
        ],
    },
    minCapacity: 0,
    maxCapacity: 10,
    desiredCapacity: 5,
});
new autoscaling.AutoScalingGroup(stack, 'AsgWithGp3Blockdevice', {
    minCapacity: 0,
    maxCapacity: 10,
    desiredCapacity: 5,
    instanceType: ec2.InstanceType.of(ec2.InstanceClass.T3, ec2.InstanceSize.MICRO),
    machineImage: new ec2.AmazonLinuxImage(),
    blockDevices: [{
            deviceName: 'ebs',
            mappingEnabled: true,
            volume: autoscaling.BlockDeviceVolume.ebs(15, {
                deleteOnTermination: true,
                encrypted: true,
                volumeType: autoscaling.EbsDeviceVolumeType.GP3,
                throughput: 125,
            }),
        }],
    vpc,
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcuYXNnLWx0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaW50ZWcuYXNnLWx0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLHdDQUF3QztBQUN4QyxxQ0FBcUM7QUFDckMsc0NBQXNDO0FBRXRDLE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQU0sS0FBSyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztBQUV0RCxNQUFNLEVBQUUsR0FBRyxJQUFJLEdBQUcsQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRTtJQUNqRCxZQUFZLEVBQUUsSUFBSSxHQUFHLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQztJQUM5QyxZQUFZLEVBQUUsSUFBSSxHQUFHLENBQUMsZ0JBQWdCLENBQUM7UUFDckMsVUFBVSxFQUFFLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxjQUFjO1FBQ3BELE9BQU8sRUFBRSxHQUFHLENBQUMsa0JBQWtCLENBQUMsTUFBTTtLQUN2QyxDQUFDO0NBQ0gsQ0FBQyxDQUFDO0FBRUgsTUFBTSxhQUFhLEdBQUcsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUU7SUFDM0QsWUFBWSxFQUFFLElBQUksR0FBRyxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUM7SUFDL0MsWUFBWSxFQUFFLElBQUksR0FBRyxDQUFDLGdCQUFnQixDQUFDO1FBQ3JDLFVBQVUsRUFBRSxHQUFHLENBQUMscUJBQXFCLENBQUMsY0FBYztRQUNwRCxPQUFPLEVBQUUsR0FBRyxDQUFDLGtCQUFrQixDQUFDLE1BQU07S0FDdkMsQ0FBQztDQUNILENBQUMsQ0FBQztBQUVILE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFO0lBQ3BDLE1BQU0sRUFBRSxDQUFD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aW4vZW52IG5vZGVcbmltcG9ydCAqIGFzIGVjMiBmcm9tICdAYXdzLWNkay9hd3MtZWMyJztcbmltcG9ydCAqIGFzIGNkayBmcm9tICdAYXdzLWNkay9jb3JlJztcbmltcG9ydCAqIGFzIGF1dG9zY2FsaW5nIGZyb20gJy4uL2xpYic7XG5cbmNvbnN0IGFwcCA9IG5ldyBjZGsuQXBwKCk7XG5jb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soYXBwLCAnYXdzLWNkay1hc2ctaW50ZWcnKTtcblxuY29uc3QgbHQgPSBuZXcgZWMyLkxhdW5jaFRlbXBsYXRlKHN0YWNrLCAnTWFpbkxUJywge1xuICBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCd0My5taWNybycpLFxuICBtYWNoaW5lSW1hZ2U6IG5ldyBlYzIuQW1hem9uTGludXhJbWFnZSh7XG4gICAgZ2VuZXJhdGlvbjogZWMyLkFtYXpvbkxpbnV4R2VuZXJhdGlvbi5BTUFaT05fTElOVVhfMixcbiAgICBjcHVUeXBlOiBlYzIuQW1hem9uTGludXhDcHVUeXBlLlg4Nl82NCxcbiAgfSksXG59KTtcblxuY29uc3QgbHRPdmVycmlkZVQ0ZyA9IG5ldyBlYzIuTGF1bmNoVGVtcGxhdGUoc3RhY2ssICdUNGdMVCcsIHtcbiAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDRnLm1pY3JvJyksXG4gIG1hY2hpbmVJbWFnZTogbmV3IGVjMi5BbWF6b25MaW51eEltYWdlKHtcbiAgICBnZW5lcmF0aW9uOiBlYzIuQW1hem9uTGludXhHZW5lcmF0aW9uLkFNQVpPTl9MSU5VWF8yLFxuICAgIGNwdVR5cGU6IGVjMi5BbWF6b25MaW51eENwdVR5cGUuQVJNXzY0LFxuICB9KSxcbn0pO1xuXG5jb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ1ZQQycsIHtcbiAgbWF4QXpzOiAyLFxufSk7XG5cbm5ldyBhdXRvc2NhbGluZy5BdXRvU2NhbGluZ0dyb3VwKHN0YWNrLCAnQXNnRnJvbUxUJywge1xuICB2cGMsXG4gIGxhdW5jaFRlbXBsYXRlOiBsdCxcbiAgbWluQ2FwYWNpdHk6IDAsXG4gIG1heENhcGFjaXR5OiAxMCxcbiAgZGVzaXJlZENhcGFjaXR5OiA1LFxufSk7XG5cbm5ldyBhdXRvc2NhbGluZy5BdXRvU2NhbGluZ0dyb3VwKHN0YWNrLCAnQXNnV2l0aERlZmF1bHRJbnN0YW5jZVdhcm11cCcsIHtcbiAgdnBjLFxuICBsYXVuY2hUZW1wbGF0ZTogbHQsXG4gIGRlZmF1bHRJbnN0YW5jZVdhcm11cDogY2RrLkR1cmF0aW9uLnNlY29uZHMoNSksXG59KTtcblxubmV3IGF1dG9zY2FsaW5nLkF1dG9TY2FsaW5nR3JvdXAoc3RhY2ssICdBc2dGcm9tTWlwJywge1xuICB2cGMsXG4gIG1peGVkSW5zdGFuY2VzUG9saWN5OiB7XG4gICAgaW5zdGFuY2VzRGlzdHJpYnV0aW9uOiB7XG4gICAgICBvbkRlbWFuZFBlcmNlbnRhZ2VBYm92ZUJhc2VDYXBhY2l0eTogNTAsXG4gICAgfSxcbiAgICBsYXVuY2hUZW1wbGF0ZTogbHQsXG4gICAgbGF1bmNoVGVtcGxhdGVPdmVycmlkZXM6IFtcbiAgICAgIHsgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDMubWljcm8nKSB9LFxuICAgICAgeyBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCd0M2EubWljcm8nKSB9LFxuICAgICAgeyBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCd0NGcubWljcm8nKSwgbGF1bmNoVGVtcGxhdGU6IGx0T3ZlcnJpZGVUNGcgfSxcbiAgICBdLFxuICB9LFxuICBtaW5DYXBhY2l0eTogMCxcbiAgbWF4Q2FwYWNpdHk6IDEwLFxuICBkZXNpcmVkQ2FwYWNpdHk6IDUsXG59KTtcblxubmV3IGF1dG9zY2FsaW5nLkF1dG9TY2FsaW5nR3JvdXAoc3RhY2ssICdBc2dGcm9tTWlwV2l0aG91dERpc3RyaWJ1dGlvbicsIHtcbiAgdnBjLFxuICBtaXhlZEluc3RhbmNlc1BvbGljeToge1xuICAgIGxhdW5jaFRlbXBsYXRlOiBsdCxcbiAgICBsYXVuY2hUZW1wbGF0ZU92ZXJyaWRlczogW1xuICAgICAgeyBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCd0My5taWNybycpIH0sXG4gICAgICB7IGluc3RhbmNlVHlwZTogbmV3IGVjMi5JbnN0YW5jZVR5cGUoJ3QzYS5taWNybycpIH0sXG4gICAgICB7IGluc3RhbmNlVHlwZTogbmV3IGVjMi5JbnN0YW5jZVR5cGUoJ3Q0Zy5taWNybycpLCBsYXVuY2hUZW1wbGF0ZTogbHRPdmVycmlkZVQ0ZyB9LFxuICAgIF0sXG4gIH0sXG4gIG1pbkNhcGFjaXR5OiAwLFxuICBtYXhDYXBhY2l0eTogMTAsXG4gIGRlc2lyZWRDYXBhY2l0eTogNSxcbn0pO1xuXG5uZXcgYXV0b3NjYWxpbmcuQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0FzZ1dpdGhHcDNCbG9ja2RldmljZScsIHtcbiAgbWluQ2FwYWNpdHk6IDAsXG4gIG1heENhcGFjaXR5OiAxMCxcbiAgZGVzaXJlZENhcGFjaXR5OiA1LFxuICBpbnN0YW5jZVR5cGU6IGVjMi5JbnN0YW5jZVR5cGUub2YoZWMyLkluc3RhbmNlQ2xhc3MuVDMsIGVjMi5JbnN0YW5jZVNpemUuTUlDUk8pLFxuICBtYWNoaW5lSW1hZ2U6IG5ldyBlYzIuQW1hem9uTGludXhJbWFnZSgpLFxuICBibG9ja0RldmljZXM6IFt7XG4gICAgZGV2aWNlTmFtZTogJ2VicycsXG4gICAgbWFwcGluZ0VuYWJsZWQ6IHRydWUsXG4gICAgdm9sdW1lOiBhdXRvc2NhbGluZy5CbG9ja0RldmljZVZvbHVtZS5lYnMoMTUsIHtcbiAgICAgIGRlbGV0ZU9uVGVybWluYXRpb246IHRydWUsXG4gICAgICBlbmNyeXB0ZWQ6IHRydWUsXG4gICAgICB2b2x1bWVUeXBlOiBhdXRvc2NhbGluZy5FYnNEZXZpY2VWb2x1bWVUeXBlLkdQMyxcbiAgICAgIHRocm91Z2hwdXQ6IDEyNSxcbiAgICB9KSxcbiAgfV0sXG4gIHZwYyxcbn0pO1xuXG5hcHAuc3ludGgoKTtcbiJdfQ==