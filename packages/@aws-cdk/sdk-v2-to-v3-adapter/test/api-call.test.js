"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const lib_1 = require("../lib");
test('can map service name to SDK v3 client name', () => {
    expect(new lib_1.ApiCall('S3', 'Bla').v3PackageName).toBe('@aws-sdk/client-s3');
});
test.each([
    'api-gateway',
    '@aws-sdk/client-api-gateway',
    'APIGateway',
    'apigateway',
])('service %p is recognized', (service) => {
    expect(new lib_1.ApiCall(service, 'Bla').v3PackageName).toEqual('@aws-sdk/client-api-gateway');
});
test.each([
    'GetRestApi',
    'getRestApi',
    'GetRestApiCommand',
])('action %p is recognized', (action) => {
    expect(new lib_1.ApiCall('api-gateway', action).action).toEqual('GetRestApi');
});
test.each([
    'ExecuteCommand',
    'executeCommand',
    'ExecuteCommandCommand',
])('ECS action %p is recognized', (action) => {
    expect(new lib_1.ApiCall('ecs', action).action).toEqual('ExecuteCommand');
});
describe('helpers for SDKv3', () => {
    test('can load a SDK package by service name', () => {
        const sdk = new lib_1.ApiCall('S3', 'Bla');
        expect(sdk.v3PackageName).toBe('@aws-sdk/client-s3');
        sdk.initializePackage();
    });
    test('can load a SDK package by package name', () => {
        const sdk = new lib_1.ApiCall('@aws-sdk/client-s3', 'Bla');
        expect(sdk.v3PackageName).toBe('@aws-sdk/client-s3');
        sdk.initializePackage();
    });
    test('will throw when attempting to load unknown SDK package', () => {
        expect(() => {
            loadV3ClientPackage('@aws-sdk/client-foobar');
        }).toThrow("Service foobar client package with name '@aws-sdk/client-foobar' does not exist.");
    });
    test('will throw when attempting to load unknown SDK package using V2 style name', () => {
        expect(() => {
            loadV3ClientPackage('FooBar');
        }).toThrow("Service foobar client package with name '@aws-sdk/client-foobar' does not exist.");
    });
    describe('with a SDK package loaded', () => {
        test('can get client', () => {
            const client = getV3Client('s3');
            expect(client.config.serviceId).toBe('S3');
        });
        test('can get client with config', async () => {
            const client = getV3Client('s3', { region: 'eu-west-1' });
            const region = await client.config.region();
            expect(region).toBe('eu-west-1');
        });
        test('can get command', () => {
            const apiCall = new lib_1.ApiCall('s3', 'ListBuckets');
            const command = apiCall.findCommandClass();
            expect(command).toBeDefined();
        });
        test('will throw when attempting to get unknown command', () => {
            expect(() => {
                new lib_1.ApiCall('s3', 'FooBar').findCommandClass();
            }).toThrow('Unable to find command named: FooBarCommand');
        });
    });
});
test('flatten', () => {
    expect((0, lib_1.flatten)({
        foo: 'foo',
        bar: {
            foo: 'foo',
            bar: 'bar',
        },
        baz: [
            { foo: 'foo' },
            { bar: 'bar' },
        ],
    })).toEqual({
        'foo': 'foo',
        'bar.foo': 'foo',
        'bar.bar': 'bar',
        'baz.0.foo': 'foo',
        'baz.1.bar': 'bar',
    });
});
test.each([
    { transformToString: () => 'foo' },
    Buffer.from('foo'),
    new TextEncoder().encode('foo'),
])('coerce %p', async (fooValue) => {
    expect(await (0, lib_1.coerceSdkv3Response)({
        foo: fooValue,
    })).toEqual({ foo: 'foo' });
});
function loadV3ClientPackage(service) {
    const apiCall = new lib_1.ApiCall(service, 'Bla');
    apiCall.initializePackage();
    return apiCall.v3Package;
}
function getV3Client(service, options = {}) {
    const apiCall = new lib_1.ApiCall(service, 'Bla');
    apiCall.initializePackage();
    apiCall.initializeClient(options);
    return apiCall.client;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLWNhbGwudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImFwaS1jYWxsLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxnQ0FBOEU7QUFFOUUsSUFBSSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtJQUN0RCxNQUFNLENBQUMsSUFBSSxhQUFPLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0FBQzVFLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLElBQUksQ0FBQztJQUNSLGFBQWE7SUFDYiw2QkFBNkI7SUFDN0IsWUFBWTtJQUNaLFlBQVk7Q0FDYixDQUFDLENBQUMsMEJBQTBCLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRTtJQUN6QyxNQUFNLENBQUMsSUFBSSxhQUFPLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0FBQzNGLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLElBQUksQ0FBQztJQUNSLFlBQVk7SUFDWixZQUFZO0lBQ1osbUJBQW1CO0NBQ3BCLENBQUMsQ0FBQyx5QkFBeUIsRUFBRSxDQUFDLE1BQU0sRUFBRSxFQUFFO0lBQ3ZDLE1BQU0sQ0FBQyxJQUFJLGFBQU8sQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQzFFLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLElBQUksQ0FBQztJQUNSLGdCQUFnQjtJQUNoQixnQkFBZ0I7SUFDaEIsdUJBQXVCO0NBQ3hCLENBQUMsQ0FBQyw2QkFBNkIsRUFBRSxDQUFDLE1BQU0sRUFBRSxFQUFFO0lBQzNDLE1BQU0sQ0FBQyxJQUFJLGFBQU8sQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENB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LENBQUM7QUFFRCxTQUFTLFdBQVcsQ0FBQyxPQUFlLEVBQUUsVUFBNkMsRUFBRTtJQUNuRixNQUFNLE9BQU8sR0FBRyxJQUFJLGFBQU8sQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDNUMsT0FBTyxDQUFDLGlCQUFpQixFQUFFLENBQUM7SUFDNUIsT0FBTyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2xDLE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUN4QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBpQ2FsbCwgSW52b2tlT3B0aW9ucywgY29lcmNlU2RrdjNSZXNwb25zZSwgZmxhdHRlbiB9IGZyb20gJy4uL2xpYic7XG5cbnRlc3QoJ2NhbiBtYXAgc2VydmljZSBuYW1lIHRvIFNESyB2MyBjbGllbnQgbmFtZScsICgpID0+IHtcbiAgZXhwZWN0KG5ldyBBcGlDYWxsKCdTMycsICdCbGEnKS52M1BhY2thZ2VOYW1lKS50b0JlKCdAYXdzLXNkay9jbGllbnQtczMnKTtcbn0pO1xuXG50ZXN0LmVhY2goW1xuICAnYXBpLWdhdGV3YXknLFxuICAnQGF3cy1zZGsvY2xpZW50LWFwaS1nYXRld2F5JyxcbiAgJ0FQSUdhdGV3YXknLFxuICAnYXBpZ2F0ZXdheScsXG5dKSgnc2VydmljZSAlcCBpcyByZWNvZ25pemVkJywgKHNlcnZpY2UpID0+IHtcbiAgZXhwZWN0KG5ldyBBcGlDYWxsKHNlcnZpY2UsICdCbGEnKS52M1BhY2thZ2VOYW1lKS50b0VxdWFsKCdAYXdzLXNkay9jbGllbnQtYXBpLWdhdGV3YXknKTtcbn0pO1xuXG50ZXN0LmVhY2goW1xuICAnR2V0UmVzdEFwaScsXG4gICdnZXRSZXN0QXBpJyxcbiAgJ0dldFJlc3RBcGlDb21tYW5kJyxcbl0pKCdhY3Rpb24gJXAgaXMgcmVjb2duaXplZCcsIChhY3Rpb24pID0+IHtcbiAgZXhwZWN0KG5ldyBBcGlDYWxsKCdhcGktZ2F0ZXdheScsIGFjdGlvbikuYWN0aW9uKS50b0VxdWFsKCdHZXRSZXN0QXBpJyk7XG59KTtcblxudGVzdC5lYWNoKFtcbiAgJ0V4ZWN1dGVDb21tYW5kJyxcbiAgJ2V4ZWN1dGVDb21tYW5kJyxcbiAgJ0V4ZWN1dGVDb21tYW5kQ29tbWFuZCcsXG5dKSgnRUNTIGFjdGlvbiAlcCBpcyByZWNvZ25pemVkJywgKGFjdGlvbikgPT4ge1xuICBleHBlY3QobmV3IEFwaUNhbGwoJ2VjcycsIGFjdGlvbikuYWN0aW9uKS50b0VxdWFsKCdFeGVjdXRlQ29tbWFuZCcpO1xufSk7XG5cbmRlc2NyaWJlKCdoZWxwZXJzIGZvciBTREt2MycsICgpID0+IHtcbiAgdGVzdCgnY2FuIGxvYWQgYSBTREsgcGFja2FnZSBieSBzZXJ2aWNlIG5hbWUnLCAoKSA9PiB7XG4gICAgY29uc3Qgc2RrID0gbmV3IEFwaUNhbGwoJ1MzJywgJ0JsYScpO1xuICAgIGV4cGVjdChzZGsudjNQYWNrYWdlTmFtZSkudG9CZSgnQGF3cy1zZGsvY2xpZW50LXMzJyk7XG4gICAgc2RrLmluaXRpYWxpemVQYWNrYWdlKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBsb2FkIGEgU0RLIHBhY2thZ2UgYnkgcGFja2FnZSBuYW1lJywgKCkgPT4ge1xuICAgIGNvbnN0IHNkayA9IG5ldyBBcGlDYWxsKCdAYXdzLXNkay9jbGllbnQtczMnLCAnQmxhJyk7XG4gICAgZXhwZWN0KHNkay52M1BhY2thZ2VOYW1lKS50b0JlKCdAYXdzLXNkay9jbGllbnQtczMnKTtcbiAgICBzZGsuaW5pdGlhbGl6ZVBhY2thZ2UoKTtcbiAgfSk7XG5cbiAgdGVzdCgnd2lsbCB0aHJvdyB3aGVuIGF0dGVtcHRpbmcgdG8gbG9hZCB1bmtub3duIFNESyBwYWNrYWdlJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICBsb2FkVjNDbGllbnRQYWNrYWdlKCdAYXdzLXNkay9jbGllbnQtZm9vYmFyJyk7XG4gICAgfSkudG9UaHJvdyhcIlNlcnZpY2UgZm9vYmFyIGNsaWVudCBwYWNrYWdlIHdpdGggbmFtZSAnQGF3cy1zZGsvY2xpZW50LWZvb2JhcicgZG9lcyBub3QgZXhpc3QuXCIpO1xuICB9KTtcblxuICB0ZXN0KCd3aWxsIHRocm93IHdoZW4gYXR0ZW1wdGluZyB0byBsb2FkIHVua25vd24gU0RLIHBhY2thZ2UgdXNpbmcgVjIgc3R5bGUgbmFtZScsICgpID0+IHtcbiAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgbG9hZFYzQ2xpZW50UGFja2FnZSgnRm9vQmFyJyk7XG4gICAgfSkudG9UaHJvdyhcIlNlcnZpY2UgZm9vYmFyIGNsaWVudCBwYWNrYWdlIHdpdGggbmFtZSAnQGF3cy1zZGsvY2xpZW50LWZvb2JhcicgZG9lcyBub3QgZXhpc3QuXCIpO1xuICB9KTtcblxuICBkZXNjcmliZSgnd2l0aCBhIFNESyBwYWNrYWdlIGxvYWRlZCcsICgpID0+IHtcbiAgICB0ZXN0KCdjYW4gZ2V0IGNsaWVudCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGNsaWVudCA9IGdldFYzQ2xpZW50KCdzMycpO1xuICAgICAgZXhwZWN0KGNsaWVudC5jb25maWcuc2VydmljZUlkKS50b0JlKCdTMycpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnY2FuIGdldCBjbGllbnQgd2l0aCBjb25maWcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjbGllbnQgPSBnZXRWM0NsaWVudCgnczMnLCB7IHJlZ2lvbjogJ2V1LXdlc3QtMScgfSk7XG4gICAgICBjb25zdCByZWdpb24gPSBhd2FpdCBjbGllbnQuY29uZmlnLnJlZ2lvbigpO1xuICAgICAgZXhwZWN0KHJlZ2lvbikudG9CZSgnZXUtd2VzdC0xJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdjYW4gZ2V0IGNvbW1hbmQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcGlDYWxsID0gbmV3IEFwaUNhbGwoJ3MzJywgJ0xpc3RCdWNrZXRzJyk7XG4gICAgICBjb25zdCBjb21tYW5kID0gYXBpQ2FsbC5maW5kQ29tbWFuZENsYXNzKCk7XG4gICAgICBleHBlY3QoY29tbWFuZCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgICB0ZXN0KCd3aWxsIHRocm93IHdoZW4gYXR0ZW1wdGluZyB0byBnZXQgdW5rbm93biBjb21tYW5kJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgbmV3IEFwaUNhbGwoJ3MzJywgJ0Zvb0JhcicpLmZpbmRDb21tYW5kQ2xhc3MoKTtcbiAgICAgIH0pLnRvVGhyb3coJ1VuYWJsZSB0byBmaW5kIGNvbW1hbmQgbmFtZWQ6IEZvb0JhckNvbW1hbmQnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxudGVzdCgnZmxhdHRlbicsICgpID0+IHtcbiAgZXhwZWN0KGZsYXR0ZW4oe1xuICAgIGZvbzogJ2ZvbycsXG4gICAgYmFyOiB7XG4gICAgICBmb286ICdmb28nLFxuICAgICAgYmFyOiAnYmFyJyxcbiAgICB9LFxuICAgIGJhejogW1xuICAgICAgeyBmb286ICdmb28nIH0sXG4gICAgICB7IGJhcjogJ2JhcicgfSxcbiAgICBdLFxuICB9KSkudG9FcXVhbCh7XG4gICAgJ2Zvbyc6ICdmb28nLFxuICAgICdiYXIuZm9vJzogJ2ZvbycsXG4gICAgJ2Jhci5iYXInOiAnYmFyJyxcbiAgICAnYmF6LjAuZm9vJzogJ2ZvbycsXG4gICAgJ2Jhei4xLmJhcic6ICdiYXInLFxuICB9KTtcbn0pO1xuXG50ZXN0LmVhY2goW1xuICB7IHRyYW5zZm9ybVRvU3RyaW5nOiAoKSA9PiAnZm9vJyB9LFxuICBCdWZmZXIuZnJvbSgnZm9vJyksXG4gIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZSgnZm9vJyksXG5dKSgnY29lcmNlICVwJywgYXN5bmMgKGZvb1ZhbHVlKSA9PiB7XG4gIGV4cGVjdChhd2FpdCBjb2VyY2VTZGt2M1Jlc3BvbnNlKHtcbiAgICBmb286IGZvb1ZhbHVlLFxuICB9KSkudG9FcXVhbCh7IGZvbzogJ2ZvbycgfSk7XG59KTtcblxuZnVuY3Rpb24gbG9hZFYzQ2xpZW50UGFja2FnZShzZXJ2aWNlOiBzdHJpbmcpIHtcbiAgY29uc3QgYXBpQ2FsbCA9IG5ldyBBcGlDYWxsKHNlcnZpY2UsICdCbGEnKTtcbiAgYXBpQ2FsbC5pbml0aWFsaXplUGFja2FnZSgpO1xuICByZXR1cm4gYXBpQ2FsbC52M1BhY2thZ2U7XG59XG5cbmZ1bmN0aW9uIGdldFYzQ2xpZW50KHNlcnZpY2U6IHN0cmluZywgb3B0aW9uczogT21pdDxJbnZva2VPcHRpb25zLCAncGFyYW1ldGVycyc+ID0ge30pIHtcbiAgY29uc3QgYXBpQ2FsbCA9IG5ldyBBcGlDYWxsKHNlcnZpY2UsICdCbGEnKTtcbiAgYXBpQ2FsbC5pbml0aWFsaXplUGFja2FnZSgpO1xuICBhcGlDYWxsLmluaXRpYWxpemVDbGllbnQob3B0aW9ucyk7XG4gIHJldHVybiBhcGlDYWxsLmNsaWVudDtcbn1cbiJdfQ==