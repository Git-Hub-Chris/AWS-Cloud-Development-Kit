"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const path = require("path");
const cfnspec = require("../lib");
const schema_1 = require("../lib/schema");
function resourceAugmentationTest(resource) {
    return () => {
        const model = cfnspec.resourceAugmentation(resource);
        if (model.metrics) {
            expect(typeof (model.metrics.namespace) === 'string').toBeTruthy();
            expect(typeof (model.metrics.dimensions) === 'object').toBeTruthy();
            for (const metric of model.metrics.metrics) {
                expect(typeof metric.name === 'string').toBeTruthy();
                expect(typeof metric.documentation === 'string').toBeTruthy();
                expect(metric.type === undefined || [schema_1.MetricType.Attrib, schema_1.MetricType.Count, schema_1.MetricType.Gauge].includes(metric.type)).toBeTruthy();
            }
        }
    };
}
const files = fs.readdirSync(path.resolve(__dirname, '../lib/augmentations'));
for (const file of files) {
    const resource = file.replace(/\.json$/, '').replace(/_/g, '::');
    test(`Validate augmentation schema for ${resource}`, resourceAugmentationTest(resource));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVnbWVudGF0aW9uLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhdWdtZW50YXRpb24udGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFDN0Isa0NBQWtDO0FBQ2xDLDBDQUEyQztBQUUzQyxTQUFTLHdCQUF3QixDQUFDLFFBQWdCO0lBQ2hELE9BQU8sR0FBRyxFQUFFO1FBQ1YsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRXJELElBQUksS0FBSyxDQUFDLE9BQU8sRUFBRTtZQUNqQixNQUFNLENBQUMsT0FBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEtBQUssUUFBUSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDbEUsTUFBTSxDQUFDLE9BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLFFBQVEsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ25FLEtBQUssTUFBTSxNQUFNLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUU7Z0JBQzFDLE1BQU0sQ0FBQyxPQUFPLE1BQU0sQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7Z0JBQ3JELE1BQU0sQ0FBQyxPQUFPLE1BQU0sQ0FBQyxhQUFhLEtBQUssUUFBUSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7Z0JBQzlELE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLFNBQVMsSUFBSSxDQUFDLG1CQUFVLENBQUMsTUFBTSxFQUFFLG1CQUFVLENBQUMsS0FBSyxFQUFFLG1CQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO2FBQ2pJO1NBQ0Y7SUFDSCxDQUFDLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxzQkFBc0IsQ0FBQyxDQUFDLENBQUM7QUFDOUUsS0FBSyxNQUFNLElBQUksSUFBSSxLQUFLLEVBQUU7SUFDeEIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNqRSxJQUFJLENBQUMsb0NBQW9DLFFBQVEsRUFBRSxFQUFFLHdCQUF3QixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7Q0FDMUYiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgY2Zuc3BlYyBmcm9tICcuLi9saWInO1xuaW1wb3J0IHsgTWV0cmljVHlwZSB9IGZyb20gJy4uL2xpYi9zY2hlbWEnO1xuXG5mdW5jdGlvbiByZXNvdXJjZUF1Z21lbnRhdGlvblRlc3QocmVzb3VyY2U6IHN0cmluZykge1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGNvbnN0IG1vZGVsID0gY2Zuc3BlYy5yZXNvdXJjZUF1Z21lbnRhdGlvbihyZXNvdXJjZSk7XG5cbiAgICBpZiAobW9kZWwubWV0cmljcykge1xuICAgICAgZXhwZWN0KHR5cGVvZihtb2RlbC5tZXRyaWNzLm5hbWVzcGFjZSkgPT09ICdzdHJpbmcnKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QodHlwZW9mKG1vZGVsLm1ldHJpY3MuZGltZW5zaW9ucykgPT09ICdvYmplY3QnKS50b0JlVHJ1dGh5KCk7XG4gICAgICBmb3IgKGNvbnN0IG1ldHJpYyBvZiBtb2RlbC5tZXRyaWNzLm1ldHJpY3MpIHtcbiAgICAgICAgZXhwZWN0KHR5cGVvZiBtZXRyaWMubmFtZSA9PT0gJ3N0cmluZycpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgZXhwZWN0KHR5cGVvZiBtZXRyaWMuZG9jdW1lbnRhdGlvbiA9PT0gJ3N0cmluZycpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgZXhwZWN0KG1ldHJpYy50eXBlID09PSB1bmRlZmluZWQgfHwgW01ldHJpY1R5cGUuQXR0cmliLCBNZXRyaWNUeXBlLkNvdW50LCBNZXRyaWNUeXBlLkdhdWdlXS5pbmNsdWRlcyhtZXRyaWMudHlwZSkpLnRvQmVUcnV0aHkoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbmNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uL2xpYi9hdWdtZW50YXRpb25zJykpO1xuZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gIGNvbnN0IHJlc291cmNlID0gZmlsZS5yZXBsYWNlKC9cXC5qc29uJC8sICcnKS5yZXBsYWNlKC9fL2csICc6OicpO1xuICB0ZXN0KGBWYWxpZGF0ZSBhdWdtZW50YXRpb24gc2NoZW1hIGZvciAke3Jlc291cmNlfWAsIHJlc291cmNlQXVnbWVudGF0aW9uVGVzdChyZXNvdXJjZSkpO1xufVxuIl19