{
  "Resources": {
    "domainFBFFA2F6": {
      "Type": "AWS::CodeArtifact::Domain",
      "Properties": {
        "DomainName": "example-domain-upstream",
        "PermissionsPolicyDocument": {
          "Statement": [
            {
              "Action": "codeartifact:GetAuthorizationToken",
              "Effect": "Allow",
              "Principal": {
                "AWS": {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":iam::",
                      {
                        "Ref": "AWS::AccountId"
                      },
                      ":root"
                    ]
                  ]
                }
              },
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        }
      }
    },
    "repository5D02F86B": {
      "Type": "AWS::CodeArtifact::Repository",
      "Properties": {
        "RepositoryName": "repository",
        "ExternalConnections": [
          "public:npmjs"
        ],
        "PermissionsPolicyDocument": {
          "Statement": [
            {
              "Action": [
                "codeartifact:DescribePackageVersion",
                "codeartifact:DescribeRepository",
                "codeartifact:GetPackageVersionReadme",
                "codeartifact:GetRepositoryEndpoint",
                "codeartifact:ListPackageVersionAssets",
                "codeartifact:ListPackageVersionDependencies",
                "codeartifact:ListPackageVersions",
                "codeartifact:ListPackages",
                "codeartifact:ReadFromRepository"
              ],
              "Effect": "Allow",
              "Principal": {
                "AWS": {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":iam::",
                      {
                        "Ref": "AWS::AccountId"
                      },
                      ":root"
                    ]
                  ]
                }
              },
              "Resource": "*"
            },
            {
              "Action": [
                "codeartifact:PublishPackageVersion",
                "codeartifact:PutPackageMetadata"
              ],
              "Effect": "Allow",
              "Principal": {
                "AWS": {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":iam::",
                      {
                        "Ref": "AWS::AccountId"
                      },
                      ":root"
                    ]
                  ]
                }
              },
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "DomainName": "example-domain-upstream"
      },
      "DependsOn": [
        "domainFBFFA2F6"
      ]
    },
    "subrepository65E28DB9": {
      "Type": "AWS::CodeArtifact::Repository",
      "Properties": {
        "RepositoryName": "sub-repository",
        "PermissionsPolicyDocument": {
          "Statement": [
            {
              "Action": [
                "codeartifact:DescribePackageVersion",
                "codeartifact:DescribeRepository",
                "codeartifact:GetPackageVersionReadme",
                "codeartifact:GetRepositoryEndpoint",
                "codeartifact:ListPackageVersionAssets",
                "codeartifact:ListPackageVersionDependencies",
                "codeartifact:ListPackageVersions",
                "codeartifact:ListPackages",
                "codeartifact:ReadFromRepository"
              ],
              "Effect": "Allow",
              "Principal": {
                "AWS": {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":iam::",
                      {
                        "Ref": "AWS::AccountId"
                      },
                      ":root"
                    ]
                  ]
                }
              },
              "Resource": "*"
            },
            {
              "Action": [
                "codeartifact:PublishPackageVersion",
                "codeartifact:PutPackageMetadata"
              ],
              "Effect": "Allow",
              "Principal": {
                "AWS": {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":iam::",
                      {
                        "Ref": "AWS::AccountId"
                      },
                      ":root"
                    ]
                  ]
                }
              },
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "Upstreams": [
          "repository"
        ],
        "DomainName": "example-domain-upstream"
      },
      "DependsOn": [
        "domainFBFFA2F6",
        "repository5D02F86B"
      ]
    }
  }
}